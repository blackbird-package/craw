#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/devel/project/blackbird/apps/craw/src/craw -o /home/devel/project/blackbird/apps/craw/pkg/craw 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[0]))
	"\225\051\251\120\200\114\013\140\347\216\313\104\126\163\361\216"
	"\317\171\030\040\133\356\336\365\330\152"
#define      text_z	4961
#define      text	((&data[1230]))
	"\310\325\173\140\364\055\355\146\360\050\202\071\005\177\013\233"
	"\141\020\124\240\007\341\312\321\277\277\251\052\227\241\337\137"
	"\167\132\277\153\207\255\322\170\325\124\261\333\323\275\167\065"
	"\316\313\326\326\254\240\247\153\140\121\225\370\362\165\127\152"
	"\317\027\325\127\305\247\317\232\374\201\166\320\076\355\005\014"
	"\270\333\343\145\174\212\320\334\333\146\324\316\333\054\070\253"
	"\104\016\002\011\266\321\244\262\122\032\202\221\010\210\236\301"
	"\143\201\046\337\014\366\274\350\135\221\267\071\276\360\344\002"
	"\376\347\014\265\270\261\150\013\313\352\235\324\163\073\225\326"
	"\274\273\266\311\262\163\261\017\004\150\111\302\130\056\305\127"
	"\025\321\014\316\202\164\332\116\137\167\042\322\262\267\251\157"
	"\163\137\070\045\322\351\065\327\121\176\231\252\255\136\001\302"
	"\060\015\221\262\202\153\000\341\342\043\264\224\333\135\003\116"
	"\275\073\164\220\045\251\147\167\050\001\041\325\140\042\230\220"
	"\060\051\103\262\224\104\223\166\147\107\013\103\245\017\222\142"
	"\113\006\362\160\257\131\347\330\133\010\255\273\053\105\114\133"
	"\156\217\015\003\324\241\171\074\350\205\177\215\224\022\360\337"
	"\030\342\117\310\074\067\240\227\077\115\123\153\223\237\306\002"
	"\057\323\005\004\164\177\100\135\004\300\353\231\322\333\170\352"
	"\276\310\263\372\000\123\221\100\241\345\253\064\205\161\067\265"
	"\104\074\271\271\274\372\026\301\272\002\132\215\336\323\170\234"
	"\234\053\226\234\176\050\334\037\015\207\124\222\370\213\110\075"
	"\310\001\366\204\373\015\106\266\020\240\104\356\164\274\212\020"
	"\347\040\255\146\111\211\206\126\020\332\351\011\146\061\107\057"
	"\063\076\264\057\114\372\346\134\233\052\112\017\346\325\040\316"
	"\365\315\064\076\126\273\225\147\226\177\161\374\260\270\054\344"
	"\367\340\023\103\332\372\237\166\044\352\205\013\277\246\331\265"
	"\163\016\363\312\312\211\062\140\010\243\135\271\134\211\235\123"
	"\151\261\226\104\253\066\272\320\040\100\333\340\346\265\225\132"
	"\304\211\044\216\022\126\356\033\372\113\324\127\325\162\253\076"
	"\043\102\203\317\170\075\240\231\176\173\171\145\061\017\277\365"
	"\230\344\204\253\073\163\306\065\277\232\215\224\015\070\323\061"
	"\172\126\001\363\224\241\215\022\035\006\170\116\026\067\104\256"
	"\033\310\132\126\073\040\214\372\273\032\217\310\122\142\372\315"
	"\271\373\300\115\234\115\140\271\124\330\010\152\017\114\031\053"
	"\025\164\202\121\224\017\114\120\051\333\031\173\075\023\110\366"
	"\016\011\104\252\127\244\144\253\175\154\026\215\271\060\271\316"
	"\244\073\037\071\112\153\211\163\107\242\357\205\266\070\174\305"
	"\101\300\160\231\145\324\104\343\101\133\160\372\213\051\311\060"
	"\145\350\151\257\124\362\043\234\225\022\041\114\113\235\021\215"
	"\136\201\046\304\126\153\247\227\306\027\221\122\101\132\202\246"
	"\103\353\126\230\336\171\064\164\214\126\300\330\364\322\145\122"
	"\123\214\026\251\367\276\101\275\326\322\020\027\055\222\276\161"
	"\176\024\011\135\216\076\321\033\225\222\363\211\144\131\333\270"
	"\345\362\142\334\261\243\232\207\166\252\237\243\075\136\025\274"
	"\162\037\031\001\136\352\034\363\175\020\174\341\151\130\232\117"
	"\113\374\053\374\237\306\203\025\161\043\271\256\201\316\153\364"
	"\356\204\365\114\157\022\077\354\043\273\316\215\024\150\334\137"
	"\145\007\133\004\316\337\032\077\003\323\356\204\242\131\170\221"
	"\335\156\335\115\201\035\071\244\330\010\061\355\161\015\114\326"
	"\025\250\332\343\210\365\043\213\311\021\020\154\152\211\375\110"
	"\367\332\225\171\367\317\036\320\327\117\276\110\135\012\037\163"
	"\263\371\127\074\357\172\310\270\214\330\044\366\141\041\077\131"
	"\374\324\322\363\243\360\304\173\100\202\303\236\215\342\022\101"
	"\334\151\175\313\344\105\204\161\035\250\147\177\311\247\331\305"
	"\173\254\271\037\235\176\232\335\001\136\174\216\101\216\320\035"
	"\370\115\351\335\222\155\116\260\026\266\060\337\135\011\245\331"
	"\265\137\370\122\336\222\060\337\360\254\156\061\073\076\117\063"
	"\213\071\020\036\246\137\317\274\025\000\234\162\011\102\114\277"
	"\241\104\022\177\326\102\137\307\357\315\371\053\013\110\136\227"
	"\202\157\266\050\317\206\345\344\206\202\127\220\304\243\117\146"
	"\347\142\346\276\244\105\206\224\023\177\277\037\310\036\267\112"
	"\216\156\163\135\364\131\101\172\333\231\013\240\075\132\007\045"
	"\274\356\343\141\064\151\366\110\351\265\147\261\324\036\374\142"
	"\215\157\300\201\310\002\374\244\233\007\105\330\142\115\375\037"
	"\074\341\200\160\113\167\270\064\054\040\346\001\077\343\144\314"
	"\122\044\115\033\046\112\300\301\121\006\232\264\123\230\323\220"
	"\171\124\000\305\313\271\372\370\331\341\371\030\304\135\344\026"
	"\201\062\062\247\174\362\151\316\371\004\202\115\235\125\335\027"
	"\251\336\334\164\227\326\154\160\270\145\211\174\303\155\223\105"
	"\237\305\355\034\270\126\352\262\133\154\377\370\301\334\017\152"
	"\272\354\337\122\303\113\302\173\261\113\367\164\271\213\271\131"
	"\121\246\165\012\375\137\274\131\313\274\121\215\231\141\370\124"
	"\115\327\246\020\042\151\213\324\265\203\110\156\017\002\310\140"
	"\251\075\152\247\235\047\000\151\343\121\366\174\263\356\320\000"
	"\305\166\021\350\266\012\055\266\255\266\057\373\257\103\347\006"
	"\004\162\224\003\133\374\165\335\256\213\125\137\341\061\273\073"
	"\364\306\143\035\056\113\032\241\300\000\115\235\236\064\223\351"
	"\156\262\163\165\210\112\172\060\301\251\237\324\241\207\070\146"
	"\126\333\137\267\046\101\006\134\213\141\053\375\255\140\334\015"
	"\003\143\313\057\211\311\174\120\053\157\220\161\227\070\362\317"
	"\153\262\104\322\031\234\334\144\324\210\104\005\317\352\100\274"
	"\243\046\277\173\357\142\261\220\164\267\074\300\354\233\370\254"
	"\332\111\062\205\277\146\115\277\254\011\027\321\060\025\375\330"
	"\151\220\234\031\257\032\000\302\221\202\274\002\152\102\303\052"
	"\320\162\231\143\163\242\105\356\376\255\153\051\224\255\177\126"
	"\265\152\167\175\003\133\111\260\215\041\157\357\262\335\226\157"
	"\354\230\072\105\367\275\365\220\141\201\265\224\135\160\322\325"
	"\022\136\234\064\362\346\346\325\074\252\157\207\374\167\365\260"
	"\002\210\020\230\332\305\110\235\124\202\321\212\300\003\202\221"
	"\265\127\107\202\337\306\135\076\065\127\045\332\217\002\312\370"
	"\013\246\147\215\262\142\331\211\176\104\041\073\161\352\075\357"
	"\245\225\133\212\133\327\046\222\022\043\114\107\114\277\077\216"
	"\325\143\306\302\335\256\015\246\262\130\076\166\130\360\141\367"
	"\176\016\121\352\017\332\120\115\224\270\156\235\013\134\246\152"
	"\313\107\301\017\010\353\261\364\202\322\111\264\242\102\033\371"
	"\061\231\167\317\074\150\171\167\210\367\136\224\046\367\176\355"
	"\321\100\353\072\262\013\210\312\064\047\244\020\345\253\371\267"
	"\332\073\312\266\000\267\351\037\046\301\136\157\356\133\366\253"
	"\216\136\340\314\042\267\330\347\014\123\304\346\251\244\156\234"
	"\106\261\006\367\307\133\254\335\065\356\142\153\277\126\070\125"
	"\020\372\035\274\144\276\127\347\306\110\063\063\141\117\362\105"
	"\222\031\143\326\006\176\362\300\147\200\335\026\110\102\044\217"
	"\323\054\320\155\015\322\132\077\302\175\255\252\117\217\005\250"
	"\217\162\170\057\316\264\007\270\012\170\312\044\315\126\373\322"
	"\225\331\370\277\241\204\115\253\040\154\357\227\244\262\223\266"
	"\062\127\231\140\073\276\276\247\306\273\001\152\072\033\007\014"
	"\214\250\165\063\306\131\302\334\321\020\260\037\330\250\311\352"
	"\263\022\243\317\321\052\122\040\037\103\101\377\236\374\062\123"
	"\151\135\164\025\364\235\075\172\020\053\363\127\165\021\075\074"
	"\327\123\347\173\217\075\225\141\077\120\001\142\362\260\211\161"
	"\342\112\366\116\170\360\135\307\250\320\164\031\370\261\267\032"
	"\052\376\053\372\374\062\051\124\032\325\076\070\177\162\333\057"
	"\110\262\066\000\144\375\151\150\052\075\215\107\113\201\231\352"
	"\006\261\336\335\071\262\345\073\212\264\311\163\130\325\250\174"
	"\015\124\023\135\237\136\235\340\001\270\153\255\026\223\010\273"
	"\273\324\247\056\300\075\354\273\135\214\124\005\107\156\077\071"
	"\075\300\120\167\212\150\165\324\200\317\303\113\216\055\333\177"
	"\276\034\366\256\213\213\014\001\231\163\126\007\007\206\252\346"
	"\107\331\322\164\236\122\143\024\103\374\177\103\306\212\066\002"
	"\160\371\236\002\006\345\366\237\065\054\011\324\060\211\033\353"
	"\176\075\151\107\170\365\032\136\354\027\325\206\240\246\030\126"
	"\374\051\344\103\365\017\146\124\233\273\074\275\304\145\067\110"
	"\270\053\132\236\140\367\303\241\377\235\021\011\232\316\375\010"
	"\345\035\103\306\267\302\251\314\032\171\032\122\006\277\122\373"
	"\272\153\056\376\257\062\260\125\142\267\255\321\062\052\262\372"
	"\227\233\010\006\101\257\036\101\062\342\107\027\002\215\315\030"
	"\171\211\305\135\204\240\275\075\223\360\233\102\071\372\167\351"
	"\035\027\104\363\342\276\075\025\350\330\225\366\043\035\055\232"
	"\153\136\352\350\247\003\102\014\144\024\114\376\064\061\027\114"
	"\220\000\013\275\201\033\146\016\075\166\116\353\075\301\217\314"
	"\135\136\120\367\034\164\265\145\035\102\022\352\015\056\021\375"
	"\374\260\113\126\001\071\167\024\076\037\122\207\221\076\260\224"
	"\044\374\350\051\220\143\311\243\116\107\370\211\247\276\040\341"
	"\334\044\005\014\350\141\200\304\321\304\354\103\216\323\164\000"
	"\311\215\043\327\107\163\310\146\175\156\153\273\277\303\133\065"
	"\247\225\176\133\355\176\233\013\043\060\145\050\026\352\171\212"
	"\200\165\150\204\000\005\102\067\173\070\343\116\030\210\032\310"
	"\124\120\103\337\070\113\005\021\235\173\212\001\114\074\276\303"
	"\337\345\050\201\027\201\013\376\340\275\114\066\331\135\312\173"
	"\151\231\327\255\005\351\347\054\370\170\063\335\226\346\173\262"
	"\126\343\362\272\123\201\263\356\273\107\310\155\240\370\352\353"
	"\243\312\047\202\004\121\010\220\156\250\320\266\064\341\337\274"
	"\325\104\033\146\220\113\067\147\026\312\062\015\203\253\205\277"
	"\062\131\255\360\067\312\357\354\362\257\156\353\202\126\136\175"
	"\010\364\101\235\037\323\156\311\113\034\007\077\140\222\056\203"
	"\311\226\301\015\145\120\046\277\042\077\372\320\061\145\020\305"
	"\035\363\060\133\136\267\317\352\005\143\122\045\163\214\363\050"
	"\372\000\064\345\363\210\341\057\200\234\375\373\002\323\321\161"
	"\157\033\307\356\236\042\306\217\117\243\063\201\210\112\351\042"
	"\145\112\175\100\235\214\251\363\076\372\260\364\030\144\211\344"
	"\106\333\217\377\322\105\122\321\072\246\152\313\264\134\001\334"
	"\342\256\260\040\323\052\170\304\376\260\264\021\355\361\372\204"
	"\111\163\161\104\251\126\261\220\027\162\267\264\253\332\234\354"
	"\010\174\346\121\345\112\116\273\235\305\342\202\024\261\167\127"
	"\362\053\254\221\357\243\110\172\104\050\132\157\157\143\203\043"
	"\076\050\131\204\124\334\327\161\324\013\015\077\066\333\347\014"
	"\254\356\153\031\275\241\262\045\341\165\210\036\051\000\144\070"
	"\236\361\023\001\233\205\375\155\143\037\323\232\154\301\067\277"
	"\014\060\122\340\017\331\072\022\164\034\334\264\030\021\206\154"
	"\220\055\106\041\060\064\145\210\035\220\151\114\005\044\342\370"
	"\004\251\350\120\143\163\003\106\041\036\211\111\247\137\002\126"
	"\014\220\234\242\146\356\077\111\360\307\232\176\022\362\163\322"
	"\045\130\336\215\253\157\326\350\251\014\342\264\322\246\072\163"
	"\327\337\002\217\325\252\112\304\241\045\251\073\003\213\067\164"
	"\177\270\130\214\043\017\254\070\174\350\057\166\143\106\052\007"
	"\042\213\054\260\161\367\070\164\146\166\243\177\222\244\327\335"
	"\002\242\312\103\050\111\001\300\066\123\236\056\201\125\004\150"
	"\270\024\166\017\055\137\067\316\377\170\330\027\360\272\376\102"
	"\365\211\141\023\247\263\241\117\216\026\337\115\131\142\370\065"
	"\226\250\002\034\106\364\234\311\024\104\027\176\103\073\170\350"
	"\343\020\153\001\013\135\203\051\210\257\025\120\064\236\127\245"
	"\305\304\176\376\254\261\337\307\034\042\137\024\023\016\363\055"
	"\241\350\225\005\204\137\073\216\323\252\177\327\047\274\134\260"
	"\312\227\315\163\204\374\360\075\254\001\147\166\025\205\203\127"
	"\351\166\203\044\372\366\211\120\211\226\354\113\372\017\351\010"
	"\314\261\301\070\014\012\173\352\062\313\346\133\066\311\135\002"
	"\210\017\021\014\127\102\144\110\206\222\375\050\324\010\060\065"
	"\121\176\310\365\214\143\365\175\246\057\246\222\063\375\244\231"
	"\326\057\077\135\022\256\151\366\377\270\263\112\055\036\050\205"
	"\241\265\046\002\037\071\213\307\231\374\314\170\241\363\154\116"
	"\175\325\270\220\122\210\337\326\327\001\002\140\361\072\170\062"
	"\177\005\056\046\123\106\207\322\134\364\134\070\320\371\172\377"
	"\243\062\367\351\327\220\175\137\201\217\246\015\226\142\112\307"
	"\345\033\263\264\205\257\022\127\163\305\247\121\220\260\170\057"
	"\161\267\236\275\066\166\317\017\157\343\212\232\162\045\135\005"
	"\336\022\235\072\075\235\372\141\153\061\345\211\204\022\305\034"
	"\073\171\312\337\055\061\172\051\072\044\276\333\035\202\077\350"
	"\120\050\361\000\174\014\100\033\023\135\105\121\325\115\206\036"
	"\130\022\215\236\030\047\123\325\145\054\246\247\101\065\317\056"
	"\162\355\304\214\333\312\347\200\210\241\102\170\055\316\234\377"
	"\144\302\120\306\070\027\332\057\220\311\060\004\320\012\370\020"
	"\256\067\353\322\315\137\334\171\273\263\225\124\043\035\113\130"
	"\114\226\373\052\146\137\255\365\256\000\041\112\364\013\065\332"
	"\250\132\067\331\347\166\045\330\354\210\145\121\147\042\156\121"
	"\353\172\132\015\222\037\106\032\246\242\160\264\201\260\250\154"
	"\345\274\022\150\103\155\345\117\166\004\227\327\253\075\244\172"
	"\053\151\010\237\230\144\321\024\017\035\341\306\354\060\142\240"
	"\112\256\227\020\151\246\256\326\002\157\270\236\357\222\205\213"
	"\266\171\202\251\137\061\057\000\351\277\352\010\177\023\122\306"
	"\065\000\126\253\264\161\347\021\230\175\225\323\013\122\224\320"
	"\035\357\203\223\064\070\277\243\320\371\170\072\247\002\137\250"
	"\253\023\317\350\002\107\050\205\066\025\050\124\102\057\146\015"
	"\251\232\077\235\064\071\234\065\302\065\135\066\112\070\021\302"
	"\353\310\154\151\362\026\326\307\152\132\330\200\112\340\110\353"
	"\110\015\001\335\214\347\010\142\160\245\215\027\100\330\245\055"
	"\051\242\240\136\210\106\145\307\123\000\301\005\313\036\202\140"
	"\202\236\043\036\131\112\236\341\167\122\124\064\330\067\057\061"
	"\347\022\321\365\372\357\315\201\246\273\376\315\262\375\274\175"
	"\035\054\351\302\234\045\047\015\250\357\245\073\265\124\001\031"
	"\233\065\207\224\322\140\267\040\233\164\202\062\005\233\307\275"
	"\257\070\377\125\003\214\264\125\242\016\302\371\016\043\337\204"
	"\241\237\135\022\243\244\015\266\034\177\232\363\343\147\213\002"
	"\054\207\217\277\210\007\122\314\126\014\107\336\032\324\307\037"
	"\003\023\001\305\007\354\375\303\050\027\025\146\075\076\265\334"
	"\342\242\151\050\325\045\063\274\372\041\010\140\371\247\050\230"
	"\231\366\357\002\220\177\304\244\042\033\267\213\240\035\050\345"
	"\227\275\366\374\263\031\303\356\025\221\072\177\104\126\365\350"
	"\122\050\346\151\243\150\311\234\025\316\345\060\025\275\041\060"
	"\347\305\351\221\047\022\032\304\003\221\117\132\223\225\142\035"
	"\333\175\360\003\046\136\377\060\247\103\321\021\150\175\040\234"
	"\132\152\260\220\225\367\157\073\156\270\035\215\252\323\370\254"
	"\116\173\006\102\364\274\022\374\161\142\017\061\207\374\062\106"
	"\105\333\326\065\034\070\173\331\314\236\211\130\031\130\276\254"
	"\160\206\066\216\017\200\110\112\364\255\073\103\374\020\161\023"
	"\142\155\134\237\110\356\002\353\355\333\040\375\124\004\107\240"
	"\074\015\150\077\361\060\026\251\072\007\373\150\245\061\034\173"
	"\156\200\075\155\205\234\325\366\105\151\152\016\245\117\032\360"
	"\043\207\274\075\310\211\354\300\355\317\154\010\054\070\224\130"
	"\235\064\227\216\312\107\017\367\277\115\341\120\343\222\262\302"
	"\231\325\114\155\245\034\330\156\162\133\105\255\256\020\311\062"
	"\125\304\120\133\270\042\304\002\016\301\241\177\305\111\364\327"
	"\326\325\306\151\160\215\263\104\054\177\276\237\132\234\265\260"
	"\003\342\354\166\313\144\126\160\142\001\270\261\133\373\206\075"
	"\303\007\166\003\070\315\310\264\106\161\201\273\023\270\334\047"
	"\011\040\124\327\071\215\373\136\301\272\220\263\012\033\062\060"
	"\044\345\056\173\206\253\346\301\122\173\310\373\275\014\352\164"
	"\047\035\050\236\206\262\144\070\236\074\361\255\000\066\112\127"
	"\153\354\253\060\221\253\104\225\160\014\101\073\331\041\047\340"
	"\324\301\000\160\271\267\232\253\153\011\064\071\214\026\151\146"
	"\133\004\365\026\026\042\046\345\342\113\075\257\026\314\117\041"
	"\343\165\053\117\316\126\167\116\222\370\066\022\317\124\263\253"
	"\050\063\077\124\064\027\126\276\306\063\107\126\004\121\011\050"
	"\122\250\017\077\060\162\337\053\361\216\307\225\161\166\373\370"
	"\077\012\375\070\356\374\326\365\110\073\315\342\362\003\265\042"
	"\270\125\227\362\112\010\011\143\100\157\177\061\344\322\246\351"
	"\227\050\046\162\247\327\062\063\100\006\270\304\147\037\334\114"
	"\222\035\304\114\124\326\051\031\041\104\227\334\242\117\024\244"
	"\142\054\065\373\353\005\151\243\324\147\140\064\353\264\027\263"
	"\233\072\011\003\254\254\305\265\156\315\046\140\073\131\213\153"
	"\156\016\010\212\002\320\103\302\024\224\230\103\363\002\204\075"
	"\344\347\066\203\261\273\361\140\062\363\267\345\065\217\201\027"
	"\146\116\204\332\336\313\334\371\244\214\121\324\176\154\312\264"
	"\164\065\022\003\311\277\202\376\360\111\004\215\115\211\013\202"
	"\261\046\215\264\161\154\317\130\120\027\074\361\104\247\004\105"
	"\000\115\256\330\272\226\370\235\307\263\024\217\307\144\277\303"
	"\130\267\245\377\212\015\130\000\062\061\054\254\121\376\317\060"
	"\317\225\356\376\040\213\151\322\374\131\337\352\205\314\130\327"
	"\365\320\163\142\264\146\254\004\141\111\265\256\050\007\272\161"
	"\320\005\227\307\011\316\255\052\265\226\017\177\201\162\024\101"
	"\065\277\137\215\234\216\017\154\164\373\222\057\060\135\300\243"
	"\365\147\104\312\362\114\031\201\342\110\176\300\370\206\026\366"
	"\153\260\022\115\220\175\202\017\372\334\326\012\277\373\260\000"
	"\002\072\221\213\226\316\373\246\006\123\065\223\215\142\317\106"
	"\125\263\146\214\127\040\144\056\011\206\374\156\262\227\357\302"
	"\260\214\330\136\203\072\005\112\306\374\167\062\151\145\341\143"
	"\230\054\340\020\325\272\043\164\213\045\376\257\261\044\237\117"
	"\253\163\230\233\147\231\271\072\335\221\325\044\002\377\021\110"
	"\122\051\212\272\072\231\361\064\027\156\143\273\172\360\000\116"
	"\012\006\371\175\145\110\145\277\043\102\252\112\140\340\247\226"
	"\267\030\146\363\152\022\372\312\214\362\317\221\016\305\271\122"
	"\210\061\274\037\116\273\303\265\146\175\167\012\347\052\106\353"
	"\223\006\272\031\000\151\035\106\344\064\356\036\336\120\220\243"
	"\175\375\350\322\164\062\247\313\104\372\327\264\345\072\222\205"
	"\320\330\121\235\127\004\026\106\264\230\303\277\076\306\166\350"
	"\212\225\061\340\223\006\350\264\253\212\210\315\272\250\366\075"
	"\026\323\275\073\106\167\053\021\131\205\136\340\145\145\217\270"
	"\233\253\120\316\016\362\234\023\102\312\057\223\204\122\131\055"
	"\312\033\341\327\172\142\101\072\105\017\031\257\327\106\077\076"
	"\232\201\141\240\322\212\135\007\313\150\143\067\003\133\033\375"
	"\227\262\271\361\241\315\222\063\305\005\267\307\255\177\053\102"
	"\321\162\302\252\304\020\065\304\262\013\342\341\134\222\135\150"
	"\123\013\227\042\271\354\176\035\333\241\327\045\023\073\201\016"
	"\003\131\054\134\226\031\353\316\331\220\234\001\130\203\365\020"
	"\050\365\150\223\226\317\133\253\307\173\153\215\057\106\347\007"
	"\105\145\153\255\315\106\330\035\354\166\003\115\166\166\275\225"
	"\255\021\120\244\264\026\366\165\022\022\015\012\152\257\365\144"
	"\235\145\111\273\222\230\141\222\235\203\157\147\067\253\255\277"
	"\151\237\133\132\075\312\074\114\046\356\301\055\207\053\304\031"
	"\237\005\224\303\322\237\172\175\054\013\126\065\021\043\353\236"
	"\164\342\070\201\164\205\062\301\353\370\012\140\103\037\353\315"
	"\143\032\057\161\067\317\373\162\071\324\206\133\371\253\340\341"
	"\230\173\236\110\307\217\266\165\050\242\136\151\331\164\002\071"
	"\070\336\232\244\103\357\344\217\347\331\272\314\334\311\001\241"
	"\277\303\350\141\036\056\025\316\333\065\234\336\173\077\044\276"
	"\066\351\030\201\341\206\234\050\150\150\202\206\101\144\054\000"
	"\053\237\352\314\311\144\116\272\274\310\174\350\145\315\045\004"
	"\264\151\374\306\357\042\373\312\267\063\050\236\046\201\056\344"
	"\057\152\173\343\326\230\250\304\333\245\122\303\043\263\322\152"
	"\167\077\224\313\223\111\245\125\120\032\127\004\265\204\154\260"
	"\313\306\324\025\051\000\226\226\157\124\376\344\364\336\207\231"
	"\162\230\051\114\002\165\305\132\050\343\170\110\164\014\000\345"
	"\203\043\277\060\077\006\033\230\170\202\372\005\264\262\065\165"
	"\160\103\107\101\200\273\372\374\101\065\354\326\324\360\064\246"
	"\012\067\217\064\331\031\206\272\170\110\355\055\173\065\053\220"
	"\006\236\035\206\156\347\201\303\206\040\207\043\357\016\323\171"
	"\126\312\111\004\025\000\200\303\227\077\100\323\152\126\221\241"
	"\153\140\341\070\070\232\203\124\020\263\155\251\235\265\350\237"
	"\271\340\207\220\125\321\124\256\041\353\144\156\022\102\137\351"
	"\327\364\162\166\216\274\251\230\270\142\121\256\121\215\055\152"
	"\337\275\231\077\121\172\100\057\240\002\227\302\340\100\260\004"
	"\014\176\022\124\051\062\217\376\136\174\054\300\224\306\013\134"
	"\175\322\054\353\342\214\214\241\371\270\002\065\360\051\144\307"
	"\013\021\156\217\235\174\147\340\046\105\367\127\017\067\126\212"
	"\001\216\043\004\041\375\031\375\072\141\075\041\206\377\345\134"
	"\370\367\161\336\150\051\074\152\146\127\276\370\371\066\207\274"
	"\141\041\350\052\014\114\143\053\157\342\124\252\115\177\246\314"
	"\177\316\066\103\243\217\231\252\163\174\314\262\002\263\273\006"
	"\377\210\056\045\276\344\021\144\055\212\253\221\021\211\140\250"
	"\341\337\322\361\242\056\074\263\214\143\110\244\052\244\356\246"
	"\320\045\251\377\372\313\146\244\223\342\101\157\077\027\152\107"
	"\057\264\125\377\220\276\340\327\101\253\150\234\260\271\235\261"
	"\135\326\137\036\103\370\251\224\236\021\143\076\026\343\012\142"
	"\135\367\127\316\230\155\220\017\167\332\033\230\164\047\134\306"
	"\236\062\044\307\220\355\030\136\045\044\127\225\120\274\056\247"
	"\172\317\370\025\111\267\075\377\105\327\134\023\257\302\166\137"
	"\030\262\100\025\070\006\156\364\203\000\112\321\165\037\035\117"
	"\020\014\314\220\330\164\015\370\125\370\333\165\221\104\305\266"
	"\130\236\064\344\173\116\040\037\305\075\046\304\141\072\034\021"
	"\374\344\160\275\025\263\036\060\262\105\300\117\177\376\024\334"
	"\351\246\005\011\010\053\044\343\146\361\050\232\166\117\316\375"
	"\167\317\272\100\240\122\206\372\310\325\044\057\072\070\077\220"
	"\137\007\030\011\366\143\305\225\372\007\142\007\375\057\270\063"
	"\355\152\057\120\021\356\046\147\227\042\370\006\026\111\030\117"
	"\341\336\071\012\316\272\371\346\056\324\116\370\136\367\157\005"
	"\057\303\167\015\231\344\236\257\347\117\377\306\044\110\337\355"
	"\025\273\104\130\050\055\055\320\151\327\040\027\207\313\243\215"
	"\306\014\363\110\124\031\321\217\142\220\172\103\055\122\221\224"
	"\151\205\003\353\363\051\142\014\103\304\224\026\170\005\313\202"
	"\235\026\306\165\043\132\156\256\247\076\230\043\124\075\066\117"
	"\143\253\150\123\147\034\114\016\226\334\354\323\033\002\025\274"
	"\374\050\366\346\217\223\346\170\144\024\173\152\020\260\103\133"
	"\363\012\067\007\156\016\007\171\065\102\106\066\347\266\327\233"
	"\000\101\130\223\206\360\016\200\213\353\242\257\255\116\125\104"
	"\332\057\325\244\357\321\237\277\337\345\036\135\330\220\117\261"
	"\054\352\322\212\307\357\373\230\327\202\364\343\272\136\036\222"
	"\236\026\126\011\311\100\247\173\065\034\145\100\033\014\257\371"
	"\031\075\304\060\203\002\043\105\372\155\025\003\076\313\235\271"
	"\102\152\127\075\014\100\141\201\261\213\034\103\033\023\070\217"
	"\371\016\311\165\035\334\374\353\014\255\035\367\026\034\267\054"
	"\145\065\345\065\355\006\074\033\273\167\145\052\160\346\042\210"
	"\147\255\164\372\366\143\360\173\047\121\014\357\071\122\260\313"
	"\047\062\246\213\273\106\244\362\237\014\036\030\070\342\124\303"
	"\352\362\207\105\206\372\333\350\253\120\357\142\107\150\261\344"
	"\010\342\122\042\362\003\057\202\355\004\276\001\150\016\125\073"
	"\140\347\364\105\013\314\324\203\000\175\153\232\357\167\135\344"
	"\112\032\142\020\014\336\376\244\334\062\120\340\365\136\061\031"
	"\162\136\223\177\065\207\235\241\300\116\070\360\363\032\056\364"
	"\372\113\042\367\134\377\003\214\364\172\374\244\207\332\002\250"
	"\372\353\216\250\174\146\265\304\041\214\320\114\123\044\316\344"
	"\326\033\234\107\334\371\046\012\304\237\275\371\036\166\300\173"
	"\356\131\334\132\314\314\013\074\162\075\243\110\031\337\301\227"
	"\201\253\321\006\156\037\270\155\145\143\107\223\171\164\152\255"
	"\204\121\253\243\312\374\070\137\064\162\060\324\265\212\153\027"
	"\151\005\323\164\032\314\042\064\001\141\003\213\021\031\023\011"
	"\253\212\137\154\171\074\353\016\077\060\266\064\322\030\333\270"
	"\116\125\125\113\310\140\173\214\047\004\153\265\301\353\301\040"
	"\216\220\231\172\110\223\251\344\371\342\214\056\074\205\031\147"
	"\073\041\062\074\331\272\221\001\073\164\167\140\004\057\222\110"
	"\347\007\133\121\177\265\121\162\303\314\017\144\366\054\340\174"
	"\162\013\155\200\172\335\235\073\047\264\002\266\164\333\076\030"
	"\355\321\125\170\043\124\140\276\346\116\010\102\243\013\317\241"
	"\231\140\040\034\232\350\123\065\114\374\361\367\246\373\226\211"
	"\042\326\332\121\065\132\304\347\154\272\154\324\351\211\162\117"
	"\172\037\313\345\341\355\074\154\270\164\151\256\020\311\041\245"
	"\110\071\163\056\076\066\364\120\164\315\062\367\260\317\364\347"
	"\052\012\255\213\313\253\071\077\116\216\242\046\130\213\177\043"
	"\225\173\320\101\121\324\115\367\202\016\367\372\342\060\255\051"
	"\362\042\154\004\150\012\204\056\042\161\040\031\017\241\210\133"
	"\166\333\115\226\035\065\020\047\001\075\060\223\066\232\153\053"
	"\341\130\250\237\123\051\320\350\071\150\325\200\155\353\023\201"
	"\341\217\332\337\313\211\275\346\211\115\131\031\335\044\251\212"
	"\277\032\004\271\035\064\264\005\344\121\230\246\026\044\241\233"
	"\347\245\007\053\016\227\346\122\131\056\020\015\361\050\271\120"
	"\313\103\353\212\116\215\052\122\247\350\265\232\341\166\040\012"
	"\364\074\226\366\333\337\235\274\224\041\005\003\060\010\313\220"
	"\261\010\372\130\246\042\131\017\005\253\005\201\136\364\121\137"
	"\272\310\160\243\247\016\140\074\057\146\100\137\156\013\357\040"
	"\024\352\171\272\014\322\311\021\175\317\223\334\304\344\073\176"
	"\254\254\041\124\272\201\221\351\347\321\111\126\334\070\166\361"
	"\043\360\253\060\302\165\101\100\105\324\034\011\271\130\207\146"
	"\004\251\272\277\053\113\250\023\035\362\151\371\052\340\352\116"
	"\320\226\176\222\014\300\323\121\225\357\133\116\107\343\265\114"
	"\214\160\013\270\274\264\313\331\246\064\322\321\024\275\037\344"
	"\124\235\167\140\135\112\262\362\072\016\101\202\361\366\316\176"
	"\147\331\066\043\216\001\374\064\065\316\006\112\214\045\057\340"
	"\303\247\101\041\362\364\024\054\003\125\256\364\114\175\162\263"
	"\126\251\326\345\252\322\032\340\241\040\053\056\105\132\017\011"
	"\001\121\052\364\105\076\040\110\223\317\075\340\114\260\224\243"
	"\131\153\210\003\076\242\344\337\303\017\016\010\151\035\021\153"
	"\156\073\137\264\172\200\375\015\117\072\356\233\353\203\076\104"
	"\356\307\110\054\152\054\014\055\073\032\066\244\067\110\020\245"
	"\203\160\131\376\360\127\013\100\221\372\333\174\175\032\301\153"
	"\342\011\230\114\065\244\171\160\276\257\025\365\367\045\233\173"
	"\225\365\171\206\114\205\306\336\200\242\133\376\275\034\151\237"
	"\045\002\353\132\246\145\313\144\025\340\132\015\006\365\211\233"
	"\353\003\042\070\211\350\026\011\213\161\010\110\216\162\347\263"
	"\164\323\016\032\071\332\176\117\272\331\134\300\317\346\134\272"
	"\352\177\362\163\150\011\175\363\172\205\074\011\367\043\275\153"
	"\367\314\206\060\246\004\200\141\336\335\041\255\303\176\150\255"
	"\376\132\041\146\144\236\131\337\044\225\350\034\271\245\207\261"
	"\161\016\342\030\023\142\171\361\077\233\236\003\031\007\260\027"
	"\142\321\176\306\160\330\245\225\155\215\261\047\063\071\331\244"
	"\107\273\274\132\035\066\113\135\321\352\140\352\362\021\002\124"
	"\342\200\032\123\130\277\350\306\115\232\356\200\323\307\045\033"
	"\203\342\166\240\030\301\376\351\254\136\324\236\157\327\362\122"
	"\130\015\246\261\315\217\170\032\051\147\233\375\056\301\030\262"
	"\244\216\123\275\120\121\246\375\260\173\234\037\123\217\162\254"
	"\234\030\135\152\250\326\205\321\075\040\317\154\342\350\036\206"
	"\167\161\103\310\302\352\305\163\146\142\222\272\361\005\146\216"
	"\036\304\370\306\232\175\230\330\236\147\104\200\117\143\007\306"
	"\324\113\216\227\066\124\012\234\266\235\126\247\243\275\066\301"
	"\201\056\207\033\253\040\364\112\207\070\313\327\233\322\235\160"
	"\036\054\007\124\201\022\360\067\260\107\337\123\005\025\024\206"
	"\104\234\242\360\274\226\072\103\316\005\032\152\330\270\333\366"
	"\345\342\112\146\365\073\236\245\203\175\370\210\223\015\017\327"
	"\251\261\307\145\107\001\251\026\007\304\201\337\175\134\326\142"
	"\077\041\310\064\135\146\332\341\344\322\151\167\337\170\116\211"
	"\052\026\357\161\027\230\210\037\135\011\377\332\146\325\074\245"
	"\367\005\331\124\153\264\065\120\206\237\307\146\030\026\357\102"
	"\054\336\264\104\167\075\143\324\106\142\256\255\070\353\122\057"
	"\360\054\204\134\340\272\254\147\132\163\315\163\212\275\265\266"
	"\234\152\372\024\247\135\350\356\300\227\233\370\202\356\050\163"
	"\032\255\317\372\147\174\142\302\360\057\065\172\355\353\060\212"
	"\125\053\236\375\210\207\354\111\037\210\101\242\166\152\025\220"
	"\027\345\213\176\141\355\101\121\035\166\313\013\141\374\225\267"
	"\047\064\264\260\273\241\371\332\051\073\175\237\245\222\060\274"
	"\167\274\073\330\251\174\051\307\362\365\322\124\361\150\013\030"
	"\234\300\310\130\141\301\063\212\375\260\052\242\102\132\137\272"
	"\026\232\222\300\027\274\210\012\261\133\137\242\303\152\272\140"
	"\052\203"
#define      rlax_z	1
#define      rlax	((&data[7068]))
	"\202"
#define      tst2_z	19
#define      tst2	((&data[7069]))
	"\052\163\106\035\177\070\371\017\255\046\235\376\316\122\203\130"
	"\315\021\354\235"
#define      shll_z	10
#define      shll	((&data[7091]))
	"\232\104\030\041\347\171\004\134\035\060\045\323\232\261"
#define      chk2_z	19
#define      chk2	((&data[7103]))
	"\356\213\273\077\133\202\226\032\116\115\020\112\305\077\167\355"
	"\261\047\172\367\351"
#define      pswd_z	256
#define      pswd	((&data[7124]))
	"\316\155\164\143\060\320\110\025\355\275\231\031\310\131\321\320"
	"\143\122\344\145\316\222\236\037\140\130\037\110\201\215\005\120"
	"\373\171\263\053\112\374\100\067\271\331\121\202\062\042\122\226"
	"\165\067\373\103\312\231\143\053\362\202\164\163\020\171\303\013"
	"\363\167\066\075\163\167\165\055\121\306\257\204\351\002\032\136"
	"\072\026\242\004\257\005\057\241\210\243\025\230\035\330\243\020"
	"\117\332\116\303\122\303\361\243\212\241\050\163\243\102\321\335"
	"\131\163\342\010\171\021\252\001\265\300\232\322\230\076\343\350"
	"\031\062\254\153\366\235\017\200\077\067\364\342\172\305\300\324"
	"\071\242\335\262\264\210\264\152\110\117\075\341\216\040\311\247"
	"\123\166\023\111\024\043\311\123\132\275\066\325\203\366\252\275"
	"\231\207\160\115\017\045\270\127\164\365\070\002\026\002\252\151"
	"\170\276\262\215\341\174\340\074\072\027\021\276\015\273\173\247"
	"\103\353\365\122\021\255\251\205\242\342\210\270\344\063\042\135"
	"\361\324\352\322\121\313\016\214\342\040\112\360\334\306\227\037"
	"\262\215\161\303\072\033\111\335\375\321\226\341\005\270\077\366"
	"\125\141\075\031\313\370\171\366\173\062\202\301\037\230\004\274"
	"\330\351\234\163\056\066\044\015\143\227\005\115\222\007\350\350"
	"\150\045\001\064\036\173\052"
#define      msg2_z	19
#define      msg2	((&data[7422]))
	"\133\316\104\024\133\211\124\103\006\024\237\337\236\043\000\360"
	"\315\355\234\313\170\323\137\212\035"
#define      inlo_z	3
#define      inlo	((&data[7444]))
	"\235\327\216"
#define      tst1_z	22
#define      tst1	((&data[7449]))
	"\205\301\006\011\366\324\131\076\251\345\326\166\027\352\333\332"
	"\352\116\054\327\362\003\363\133\114\212\016\336"
#define      opts_z	1
#define      opts	((&data[7475]))
	"\044"
#define      msg1_z	65
#define      msg1	((&data[7477]))
	"\057\016\111\207\061\155\112\124\337\017\200\221\066\162\000\065"
	"\042\253\312\317\055\344\246\172\022\365\363\200\030\237\334\200"
	"\160\200\370\056\107\055\116\303\363\344\237\327\167\301\263\020"
	"\275\361\006\352\324\015\075\112\217\163\036\263\007\276\023\332"
	"\070\073\073\105\131\325\363\006\061\302\113\221\114\150\332"
#define      lsto_z	1
#define      lsto	((&data[7555]))
	"\014"
#define      date_z	1
#define      date	((&data[7556]))
	"\042"
#define      xecc_z	15
#define      xecc	((&data[7560]))
	"\240\331\365\305\010\302\316\350\002\313\111\355\133\312\106\323"
	"\216\223\227"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
