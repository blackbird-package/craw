#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/devel/project/blackbird/apps/craw/src/craw -o /home/devel/project/blackbird/apps/craw/pkg/craw 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\142"
#define      text_z	4005
#define      text	((&data[524]))
	"\012\332\116\262\353\333\245\307\165\061\302\300\364\020\254\177"
	"\126\003\010\205\112\015\070\134\334\003\007\146\334\214\226\346"
	"\147\345\231\122\301\077\032\067\160\334\367\144\355\243\344\103"
	"\247\355\310\361\373\000\116\327\004\126\075\341\343\324\307\112"
	"\271\140\235\173\237\267\262\017\224\252\164\201\116\130\305\365"
	"\106\215\347\101\216\066\030\223\215\126\164\160\052\074\272\343"
	"\234\127\137\074\017\021\114\244\274\300\046\012\031\353\000\137"
	"\171\350\241\010\037\272\233\254\020\020\034\072\114\327\036\351"
	"\057\175\045\076\217\161\343\113\062\011\125\114\364\126\254\155"
	"\076\115\165\135\007\021\012\027\041\046\122\156\376\160\127\055"
	"\356\174\154\175\356\117\310\040\130\036\155\115\165\031\273\263"
	"\146\061\021\155\103\033\205\145\102\327\323\100\110\053\156\066"
	"\247\332\263\226\051\174\267\202\233\044\320\020\075\214\303\243"
	"\275\325\021\000\361\227\146\064\157\071\165\267\144\343\355\014"
	"\275\241\242\347\035\132\152\270\176\072\311\273\307\215\137\204"
	"\142\160\205\124\010\353\210\167\045\375\056\212\341\034\226\237"
	"\275\071\206\333\223\361\224\022\054\135\315\363\352\054\170\115"
	"\235\375\242\245\351\052\034\016\050\113\231\012\147\060\251\044"
	"\152\057\000\376\041\224\020\115\361\335\100\334\011\270\052\246"
	"\266\314\114\237\367\150\256\040\263\110\052\033\170\323\100\342"
	"\003\100\340\044\324\360\161\306\315\262\243\327\152\315\176\041"
	"\232\312\301\221\063\157\261\347\267\333\002\060\257\102\022\262"
	"\202\362\326\127\343\107\035\261\372\301\211\145\216\007\206\051"
	"\322\107\272\005\267\154\354\157\110\356\237\367\061\261\251\263"
	"\244\200\012\210\310\050\072\302\351\303\047\170\312\256\241\234"
	"\365\134\242\254\311\216\034\021\175\273\011\256\155\263\142\022"
	"\063\155\233\374\225\325\276\177\230\346\370\143\224\232\000\211"
	"\366\242\066\300\061\123\321\256\016\333\135\174\216\277\217\302"
	"\055\052\276\302\377\175\102\227\143\072\373\367\324\373\201\313"
	"\235\270\213\317\013\135\176\032\070\333\226\306\233\045\211\310"
	"\117\107\213\117\304\315\347\047\010\342\037\334\335\241\250\173"
	"\131\063\112\144\220\310\177\311\244\025\217\077\073\030\010\213"
	"\140\224\332\045\142\302\114\152\244\154\107\106\362\321\364\250"
	"\327\234\266\340\302\315\120\365\064\165\177\316\035\354\062\377"
	"\343\051\260\211\235\025\120\040\224\120\340\014\064\163\305\041"
	"\065\144\023\274\271\366\324\003\046\035\364\304\161\313\013\035"
	"\126\147\036\143\033\202\272\330\022\242\020\220\350\004\211\273"
	"\166\000\144\115\377\244\155\032\005\042\022\306\222\115\056\267"
	"\013\246\267\074\227\030\151\112\100\221\053\144\157\003\077\032"
	"\127\041\065\141\347\376\162\350\302\304\156\033\250\274\064\110"
	"\137\103\044\077\002\050\262\237\307\257\052\031\116\307\167\325"
	"\274\160\033\260\216\214\002\260\224\355\053\364\106\014\052\107"
	"\030\204\213\061\122\267\140\000\147\245\072\351\176\230\256\056"
	"\352\056\061\060\031\325\345\112\347\322\121\375\051\074\342\274"
	"\225\343\216\057\014\203\077\207\225\247\236\362\105\374\011\217"
	"\145\107\025\047\143\044\070\004\257\202\164\307\136\272\052\071"
	"\117\316\252\275\164\150\206\126\352\101\006\255\000\333\343\213"
	"\037\057\143\005\333\256\356\334\036\257\322\166\076\322\017\214"
	"\015\152\351\354\007\005\215\101\013\375\000\120\214\000\246\020"
	"\273\237\073\325\263\201\322\114\176\012\310\251\052\267\200\364"
	"\333\301\267\254\356\025\277\127\034\014\062\174\134\177\172\175"
	"\167\373\367\163\303\034\033\021\237\316\371\262\301\126\237\050"
	"\126\354\103\204\341\001\053\135\067\220\074\350\314\372\003\115"
	"\370\041\374\026\022\033\362\163\367\311\173\211\234\356\157\006"
	"\112\162\346\277\033\012\255\110\244\327\005\301\152\102\325\077"
	"\017\241\207\260\313\155\334\010\076\274\172\170\140\263\240\043"
	"\070\103\127\255\375\247\274\276\017\041\240\110\022\161\064\326"
	"\031\346\316\247\161\023\357\144\317\111\230\012\254\034\056\152"
	"\146\106\125\144\320\172\164\345\171\172\353\033\322\146\062\104"
	"\136\001\113\334\030\277\336\301\115\202\221\376\303\114\037\204"
	"\314\310\345\341\224\047\204\022\050\171\332\376\323\225\060\011"
	"\350\240\304\051\363\007\171\314\333\302\175\311\341\372\255\252"
	"\205\173\233\210\370\226\251\015\133\014\005\354\177\107\236\254"
	"\213\206\315\376\311\026\222\233\172\123\250\120\013\046\362\306"
	"\346\064\316\316\206\307\115\177\327\264\077\374\013\017\047\133"
	"\247\316\164\316\112\132\142\152\330\006\124\277\306\127\044\274"
	"\244\014\234\265\276\107\341\336\202\220\377\306\264\347\313\063"
	"\050\201\011\040\275\075\205\132\310\364\353\011\113\256\251\257"
	"\052\014\232\045\130\202\027\167\157\145\277\301\147\357\364\141"
	"\052\035\173\073\155\131\165\372\022\001\370\104\063\074\376\114"
	"\166\027\110\331\004\332\171\124\127\332\206\326\371\071\235\307"
	"\162\210\043\003\255\224\051\046\371\171\057\063\326\231\176\131"
	"\055\013\352\113\363\311\000\206\217\113\266\276\236\167\104\352"
	"\247\024\324\021\070\121\142\152\264\357\143\307\130\101\337\160"
	"\211\377\104\312\256\117\241\106\157\270\330\017\020\235\173\361"
	"\045\003\224\033\304\152\337\167\244\341\045\245\166\113\222\120"
	"\124\164\301\311\166\114\204\052\121\304\306\223\250\074\043\313"
	"\041\366\203\314\134\237\166\126\033\326\300\012\327\263\163\371"
	"\235\101\210\250\231\004\160\051\042\217\356\234\115\322\233\330"
	"\014\315\305\327\107\007\050\230\343\325\251\113\372\251\321\346"
	"\332\101\066\116\203\364\271\304\032\153\232\025\105\346\344\244"
	"\034\255\012\151\227\067\132\264\270\103\247\333\365\117\250\127"
	"\300\175\060\351\354\020\055\062\134\161\243\345\204\162\353\216"
	"\341\115\045\306\161\145\035\345\024\052\277\310\370\074\222\343"
	"\054\353\112\243\200\203\356\232\327\033\306\071\212\171\270\127"
	"\170\071\301\113\075\312\263\274\257\012\177\356\114\312\076\003"
	"\101\257\015\053\157\256\177\272\270\036\140\143\230\073\146\224"
	"\050\114\200\055\320\306\165\064\016\006\322\201\031\215\010\335"
	"\317\357\347\162\154\344\031\253\020\225\242\137\004\104\225\226"
	"\114\270\077\221\236\204\071\026\161\261\306\107\350\033\244\112"
	"\201\132\174\344\351\125\356\257\063\342\377\304\134\244\213\121"
	"\021\107\174\146\141\160\224\020\017\346\074\204\114\141\365\273"
	"\001\005\142\324\202\075\350\230\245\267\067\224\010\201\242\365"
	"\301\207\235\376\102\027\017\370\167\374\120\324\071\067\204\173"
	"\311\211\376\157\243\346\041\166\305\255\065\114\334\020\356\175"
	"\137\376\010\213\254\162\317\054\102\306\223\235\100\373\356\362"
	"\202\160\363\202\353\257\261\232\077\064\160\027\235\065\062\012"
	"\356\053\264\150\021\142\066\157\330\265\202\136\170\023\105\313"
	"\221\323\246\321\163\224\012\202\006\041\025\067\370\034\100\302"
	"\114\342\104\325\216\113\135\147\353\200\100\375\126\323\043\332"
	"\225\065\073\000\260\251\332\226\044\234\325\244\176\354\044\270"
	"\004\343\256\064\170\370\077\016\031\274\134\215\071\114\026\335"
	"\027\316\055\224\271\247\252\166\072\321\374\337\274\050\133\243"
	"\222\117\026\257\313\231\053\352\254\370\330\156\157\051\240\255"
	"\360\047\101\041\376\153\013\347\122\313\035\175\203\275\321\053"
	"\005\163\221\055\045\035\151\176\302\144\214\214\221\255\104\013"
	"\215\324\253\302\077\177\213\067\113\276\170\336\206\106\110\333"
	"\150\020\141\355\276\163\057\307\177\221\351\005\110\147\244\103"
	"\072\212\346\204\110\046\233\126\202\250\251\152\314\204\166\271"
	"\001\364\275\067\340\365\133\272\234\264\231\250\360\170\235\167"
	"\133\033\005\020\107\004\335\230\025\263\176\321\016\264\224\133"
	"\277\333\316\016\005\120\063\340\356\106\121\043\123\176\357\216"
	"\230\344\172\032\031\307\230\046\004\001\110\060\107\347\046\034"
	"\233\371\135\256\145\251\011\007\314\026\266\344\160\141\320\352"
	"\340\217\366\214\007\203\305\107\045\020\177\110\256\063\113\064"
	"\277\347\302\234\236\365\025\211\341\055\317\062\114\237\245\337"
	"\026\066\006\261\326\036\112\214\360\140\060\001\216\345\171\270"
	"\110\326\336\303\355\232\274\020\230\202\330\310\051\124\320\363"
	"\071\032\234\176\337\116\007\016\240\037\150\224\035\006\320\112"
	"\103\030\375\004\374\060\217\215\220\031\140\220\146\074\034\152"
	"\051\345\212\241\355\101\312\111\103\000\224\136\215\160\205\363"
	"\374\166\306\351\367\253\006\223\200\230\257\006\206\216\371\145"
	"\302\230\307\245\117\203\044\277\235\204\060\054\102\112\267\343"
	"\102\005\257\136\245\372\057\166\146\005\350\176\311\126\230\336"
	"\257\105\222\310\274\347\377\003\163\366\115\262\212\306\136\267"
	"\131\337\213\357\344\036\204\063\132\315\350\342\066\067\167\177"
	"\072\347\063\050\075\073\352\227\255\031\312\375\263\133\006\211"
	"\105\313\255\222\370\303\360\046\315\230\141\007\261\243\212\010"
	"\372\160\052\157\312\027\224\146\133\034\360\103\215\316\064\013"
	"\254\037\377\057\151\070\241\240\221\211\250\204\176\143\206\336"
	"\051\331\234\251\364\100\201\126\212\110\021\031\244\040\114\200"
	"\013\206\077\146\035\010\121\350\317\035\006\326\110\317\102\012"
	"\033\224\273\054\155\040\042\357\016\134\266\260\344\054\167\361"
	"\340\325\057\155\155\036\156\106\101\357\244\056\102\117\110\163"
	"\353\375\361\021\115\336\335\071\112\270\303\216\347\200\377\354"
	"\107\215\215\112\347\176\267\061\056\246\336\263\334\142\300\255"
	"\012\021\055\164\243\146\362\265\031\062\001\312\024\175\223\365"
	"\153\202\256\130\202\222\141\230\030\133\277\156\223\121\223\007"
	"\155\201\041\044\076\131\177\163\326\224\117\255\214\053\055\156"
	"\145\224\145\354\313\156\002\347\267\252\273\257\140\152\154\166"
	"\165\377\205\070\270\206\037\257\053\004\334\021\004\072\062\113"
	"\026\005\167\273\371\330\021\346\042\341\250\357\147\025\200\230"
	"\166\305\310\363\042\074\100\267\123\367\060\233\100\126\003\144"
	"\274\136\134\354\350\034\032\122\263\064\245\220\260\001\227\032"
	"\366\016\214\314\261\333\037\141\015\247\243\044\347\024\312\127"
	"\025\344\172\323\030\123\101\027\300\222\045\370\327\104\202\115"
	"\155\115\141\136\162\047\305\137\324\033\175\006\240\241\105\311"
	"\010\125\167\077\271\354\221\245\353\307\136\227\255\065\011\275"
	"\135\153\335\016\235\221\304\364\211\261\253\035\102\240\324\237"
	"\156\232\063\273\251\371\053\102\353\200\227\011\001\003\327\056"
	"\177\147\340\271\122\376\234\204\031\147\006\320\374\155\134\102"
	"\370\036\273\341\055\146\363\170\271\320\026\114\123\267\025\245"
	"\227\215\102\213\025\333\254\200\117\060\213\064\200\305\136\023"
	"\134\015\240\172\076\122\147\260\235\373\215\365\127\153\047\145"
	"\340\361\220\111\017\242\120\230\050\071\037\257\143\052\221\162"
	"\303\012\175\047\327\207\336\277\137\315\241\175\046\275\166\037"
	"\210\104\216\104\252\172\102\364\242\346\020\235\002\133\234\217"
	"\315\304\132\277\026\010\316\327\036\135\326\262\130\017\166\335"
	"\376\076\272\235\362\027\266\347\114\353\272\040\215\017\147\166"
	"\351\223\235\240\036\347\207\156\156\046\044\370\007\345\300\057"
	"\150\076\211\220\104\300\120\114\206\116\274\161\216\340\247\212"
	"\374\047\055\067\346\255\125\337\214\062\010\233\005\051\060\116"
	"\252\212\217\320\334\222\161\153\076\116\062\272\117\124\262\202"
	"\236\300\002\276\323\161\175\311\266\221\234\352\176\256\267\312"
	"\121\220\041\163\265\224\254\202\164\040\223\105\330\074\204\012"
	"\162\257\263\024\002\302\337\362\175\027\232\005\203\151\146\003"
	"\113\140\054\324\173\142\213\153\243\035\110\000\356\262\246\350"
	"\216\334\267\122\332\357\162\267\206\117\102\123\201\267\147\255"
	"\112\303\343\163\115\255\123\022\314\357\034\056\057\054\160\263"
	"\264\150\300\163\053\027\127\317\173\233\265\046\324\041\200\156"
	"\263\130\104\027\054\277\347\032\365\003\222\003\213\323\012\231"
	"\005\301\241\040\375\013\352\121\350\117\201\027\327\343\134\025"
	"\025\256\210\113\243\204\142\200\363\074\372\212\035\371\340\012"
	"\364\005\106\107\237\077\041\201\321\061\322\143\003\135\325\232"
	"\305\055\241\331\177\020\336\366\226\174\353\243\175\364\232\263"
	"\154\224\071\330\306\231\140\023\316\253\002\220\216\233\151\075"
	"\152\343\142\246\230\360\027\111\242\306\332\104\140\006\223\015"
	"\134\046\243\313\023\334\250\272\355\235\015\325\003\316\066\313"
	"\143\316\352\100\377\214\016\005\054\075\161\076\106\100\246\007"
	"\156\325\042\156\315\217\222\275\276\244\263\065\170\322\255\233"
	"\202\337\357\341\307\176\244\070\233\244\133\244\053\144\360\210"
	"\033\235\156\254\255\254\346\034\341\055\040\147\142\027\141\123"
	"\012\154\352\243\244\003\173\223\116\331\101\016\261\320\155\252"
	"\012\121\040\104\376\156\350\161\011\316\026\341\372\055\134\360"
	"\231\307\036\210\057\060\046\254\125\043\340\366\174\234\212\344"
	"\250\342\145\377\345\310\255\142\134\342\212\307\212\125\352\123"
	"\276\126\030\223\035\177\373\340\364\321\150\243\325\102\160\236"
	"\045\104\112\212\054\067\032\260\204\242\351\125\357\025\341\036"
	"\033\206\055\046\155\343\033\223\353\223\351\200\250\244\261\071"
	"\077\201\043\003\310\341\126\377\202\106\152\214\171\243\005\356"
	"\220\277\102\073\045\271\211\344\131\036\147\127\074\201\172\007"
	"\246\046\221\152\047\327\360\320\123\202\062\045\325\135\001\006"
	"\057\077\255\154\121\317\346\107\224\064\162\157\211\323\105\226"
	"\054\204\305\372\136\157\370\327\222\131\273\010\325\107\252\246"
	"\021\340\016\173\135\002\060\243\336\371\163\273\270\051\101\021"
	"\135\316\305\137\074\350\345\311\025\043\327\154\022\300\257\255"
	"\343\105\051\335\113\300\167\310\165\023\303\161\217\265\327\013"
	"\374\243\075\110\150\102\270\110\151\210\143\165\135\331\270\132"
	"\347\032\271\011\275\366\162\146\153\207\162\150\130\200\362\344"
	"\046\353\023\331\372\131\331\304\170\255\230\217\072\102\135\222"
	"\013\152\040\227\207\273\315\227\142\114\303\214\373\257\046\247"
	"\356\300\172\307\151\142\146\147\034\072\373\326\352\325\204\012"
	"\376\367\320\307\041\336\330\036\144\143\211\210\347\252\131\074"
	"\111\252\342\104\310\155\273\105\124\036\321\254\345\310\301\317"
	"\200\361\013\345\211\133\344\175\161\316\307\311\124\274\163\135"
	"\357\033\100\060\366\003\260\371\362\244\317\074\042\376\135\301"
	"\372\022\033\347\330\123\074\335\240\052\207\277\010\306\107\316"
	"\203\375\032\325\210\051\171\363\337\125\016\113\171\365\133\250"
	"\044\135\311\326\201\153\001\271\034\247\255\136\007\143\143\147"
	"\073\364\123\147\277\261\136\316\034\274\107\243\316\241\313\352"
	"\366\273\151\016\145\056\004\377\067\254\150\140\175\354\273\134"
	"\037\127\331\267\043\213\020\202\171\163\335\336\055\143\114\007"
	"\270\367\062\153\251\011\120\210\275\362\111\064\343\316\355\257"
	"\070\365\164\273\007\213\102\331\105\173\066\131\364\102\046\356"
	"\147\262\244\015\154\110\027\077\111\066\257\231\267\343\145\140"
	"\206\254\216\021\032\045\367\265\210\012\275\243\151\041\266\244"
	"\200\036\317\120\242\350\271\234\016\257\017\022\357\024\175\332"
	"\157\374\045\052\017\262\022\065\231\117\147\337\110\335\220\233"
	"\157\350\163\013\022\301\153\206\305\301\134\161\201\205\137\056"
	"\030\214\325\334\170\056\140\361\072\276\151\302\301\264\256\310"
	"\356\045\062\261\131\061\142\347\346\156\305\372\055\046\266\345"
	"\035\356\274\316\345\351\142\007\110\114\023\147\207\252\012\333"
	"\247\310\130\201\072\114\232\302\302\256\151\347\115\152\354\173"
	"\267\307\300\377\153\140\263\225\317\163\027\307\230\236\217\125"
	"\032\233\311\207\033\326\044\344\023\030\147\024\067\366\365\364"
	"\320\054\161\132\310\242\047\242\004\373\241\375\371\042\237\160"
	"\373\105\351\365\262\362\246\256\363\130\270\140\016\377\016\266"
	"\330\355\112\220\377\333\273\334\024\063\351\150\363\036\235\176"
	"\166\026\030\367\265\274\221\133\252\332\346\373\231\371\246\270"
	"\357\374\007\221\141\150\337\123\376\004\107\376\327\207\075\355"
	"\253\112\356\316\060\326\062\130\355\322\215\224\156\223\160\303"
	"\033\037\306\007\350\254\033\226\022\103\326\156\123\017\106\167"
	"\265\132\034\013\123\236\135\002\352\370\340\237\237\335\102\253"
	"\373\222\321\100\367\307\273\221\236\333\134\201\220\025\064\255"
	"\251\105\102\215\172\215\252\077\345\042\106\035\004\201\177\004"
	"\004\144\006\004\236\332\326\005\303\023\336\205\262\101\247\140"
	"\113\321\066\143\226\202\173\153\312\035\350\020\357\117\374\232"
	"\133\175\135\172\332\333\105\004\302\300\256\225\257\221\220\251"
	"\243\023\275\320\345\223\234\056\072\267\124\156\135\311\373\252"
	"\374\053\151\115\106\130\347\314\212\351\341\105\224\103\150\345"
	"\273\103\111\215\072\262\366\102\360\260\303\322\072\044\247\325"
	"\177\176\364\226\157\034\121\177\300\206\126\266\077\220\042\122"
	"\046\071\164\027\253\156\104\012\146\361\057\352\141\146\114\146"
	"\256\304\026\011\202\022\164\213\234\141\235\121\164\313\210\135"
	"\022\245\067\170\326\155\317\317\146\000\142\116\342\077\112\061"
	"\223\023\051\321\223\271\333\211\015\246\354\206\324\024\060\172"
	"\144\350\155\211\323\071\136\246\217\360\230\221\005\263\155\202"
	"\012\141\172\230\223\201\154\112\357\003\173\245\174\030\341\071"
	"\147\261\032\257\230\065\122\125\340\155\277\217\022\043\140\205"
	"\050\012\174\344\250\270\054\077\231\121\156\245\030\311\003\367"
	"\137\352\033\374\367\142\354\014\165\374\361\265\153\125\370\056"
	"\324\151\051\022\232\163\047\251\047\364\365\342\102\041\014\341"
	"\043\317\247\352\021\350\241\267\334\305\326\351\032\067\174\162"
	"\201\224\125\330\044\164\075\305\041\375\022\361\370\263\121\264"
	"\301\363\243\121\233\126\204\317\366\125\374\037\245\024\165\060"
	"\305\047\246\005\105\307\011\001\337\062\244\366\231\035\035\043"
	"\302\263\063\057\235\223\327\347\233\312\056\230\167\301\047\125"
	"\235\100\352\253\075\040\167\367\107\304\064\121\306\126\373\367"
	"\323\206\147\260\262\271\360\272\052\172\245\025\266\322\114\112"
	"\047\045\173\044\372\365\356\362\325\111\160\071\165\306\250\023"
	"\155\157\047\046\123\125\365\375\212\374\054\107\346\063\171\334"
	"\157\166\370\340\317\027\076\132\354\050\164\130\362\147\134\126"
	"\043\052\153\270\307\066\130\206\203\160\244\365\317\115\333\170"
	"\164\235\046\353\003\011\130\327\041\046\157\266\211\207\072\037"
	"\116\131\154\230\002\364\121\306\204\021\165\220\242\077\005\357"
	"\140\377\220\251\202\301\315\157\022\375\077\324\343\160\237\175"
	"\164\017\074\023\222\137\065\225\367\350\315\175\317\006\247\153"
	"\232\155\073\161\317\055\263\133\103\076\001\223\200\011\222\103"
	"\264\033\371\346\050\160\212\110\205\214\021\151\343\363\160\075"
	"\074\166\257\240\226\017\330\206\023\343\302\200\151\032\310\270"
	"\372\033\027\047\263\316\150\336\162\210\004\233\200\045\355\007"
	"\062\264\163\063\010\252\060\367\336\177\020\332\160\221\114\026"
	"\364\273\217\334\063\367\041\336\136\336\271\126\271\175\011\141"
	"\106\013\075\001\122\053\117\105\052\072\222\345\014\011\116\123"
	"\075\255\264\214\106\027\124\252\146\361\277\174\242\127\244\132"
	"\275\254\031\113\365\330\230\236\247\336\226\307\170\072\345\246"
	"\132\247\134\302\130\162\070\310\345\367\137\267\251\112\320\311"
	"\126\053\244\153\326\164\333\010\334\030\266\225\145\326\061\044"
	"\355\357\260\131\211\213\255\260\025\262\331\242\271\057\167\105"
	"\103\333\323\066\041\022\157\355\010\031\230\330\362\053\105\224"
	"\240\301\102\225\264\256\037\175\055\310\205\322\216\210\165\132"
	"\316\046\256\062\247\337\267\150\133\174\141\031\354\234\350\057"
	"\056\244\016\341\020\005\271\112\024\167\075\271\352\031\007\042"
	"\202\015\357\375\147\042\107\314\263\020\113\174\264\141\014\364"
	"\234\045\375\047\205\221\001\252\363\303\367\135\150\144\245\352"
	"\162\224\347\331\267\057\246\152\077\361\347\364\122\364\350\357"
	"\031\346\026\237\167\030\112\153\334\102\310\104\247\156\057\031"
	"\002\027\363\271\106\231\044\206\213\014\172\336\000\143\315\032"
	"\111\344\271\301\374\004\054\331\106\365\035\355\143\115\007\146"
	"\144\372\037\252\224\104\061\040\121\254\377\121\020\315\153\131"
	"\261\045\033\256\051\107\207\160\075\245\136\241\362\145\007\126"
	"\140\047\001\364\153\062\025\274\336\024\016\357\341\172\110\223"
	"\237\144\101\311\254\310\071\351\155\230\212\137\375\221\266\135"
	"\271\267\122\044\352\147\341\311\174\360\270\135\152\001\361\012"
	"\145\062\324\021\373\015\373\151\246\206\311\243\030\177"
#define      pswd_z	256
#define      pswd	((&data[4772]))
	"\122\366\041\272\330\352\066\310\242\224\063\244\205\075\011\270"
	"\021\033\263\037\027\035\305\235\346\150\266\146\151\207\235\274"
	"\176\276\166\126\251\255\036\114\101\121\360\306\217\372\177\240"
	"\025\063\300\054\120\166\360\061\073\351\057\213\325\225\177\030"
	"\060\372\175\312\163\271\040\242\104\300\157\376\113\377\350\313"
	"\031\021\217\144\210\200\225\303\151\305\117\077\133\317\127\214"
	"\312\325\126\075\216\166\337\322\066\117\321\202\116\272\115\150"
	"\313\335\314\123\135\141\027\307\047\147\006\203\066\136\017\000"
	"\063\145\075\302\334\035\225\023\154\146\225\273\040\343\043\354"
	"\300\360\100\035\122\127\345\171\276\353\374\364\112\013\365\176"
	"\161\063\100\115\120\326\141\275\074\366\171\135\332\235\111\233"
	"\215\211\271\337\341\236\130\237\212\125\224\324\141\212\123\323"
	"\275\224\040\015\152\202\313\247\171\104\004\123\341\116\356\156"
	"\330\247\116\271\106\247\131\320\374\356\245\136\170\370\061\065"
	"\214\121\103\367\323\016\236\115\123\243\240\065\361\217\244\311"
	"\066\362\203\175\231\335\115\225\313\362\363\103\352\044\171\167"
	"\166\274\156\112\313\015\227\036\260\070\123\241\307\367\153\376"
	"\351\357\173\203\314\311\030\227\273\014\333\246\061\124\036\250"
	"\021\215\363\334\232\213\372\112\303\116\353\212\105\127\211\057"
	"\106\005\262\022\316\205\312\066\356\201\235\130\011\072\024\207"
	"\371\213\335"
#define      msg2_z	19
#define      msg2	((&data[5043]))
	"\356\306\341\132\116\001\031\355\162\270\023\324\263\240\014\173"
	"\131\232\244\013\171\116\337\100"
#define      tst2_z	19
#define      tst2	((&data[5070]))
	"\176\356\363\076\302\322\101\342\235\204\134\026\241\354\031\111"
	"\343\220\211\322\134\332\164\033\104\304"
#define      chk2_z	19
#define      chk2	((&data[5094]))
	"\147\030\020\031\343\155\000\122\163\235\061\232\004\266\064\206"
	"\231\066\350\172\035\013\160\122"
#define      msg1_z	65
#define      msg1	((&data[5132]))
	"\254\325\355\344\322\334\136\040\273\237\375\225\140\174\204\123"
	"\024\365\307\005\350\237\336\025\162\022\100\044\050\026\152\021"
	"\116\111\112\366\067\317\040\213\146\031\225\340\343\314\317\165"
	"\160\135\066\263\011\344\140\021\140\257\042\110\337\374\265\157"
	"\327\124\075\030\223\157\033\364\375\301\225\136\314\137\070\146"
	"\216\272\240\227\177\206"
#define      date_z	1
#define      date	((&data[5202]))
	"\353"
#define      shll_z	10
#define      shll	((&data[5203]))
	"\273\005\267\372\266\222\354\113\144\356\175"
#define      xecc_z	15
#define      xecc	((&data[5215]))
	"\014\052\343\361\165\126\337\326\244\152\140\131\225\173\122\137"
	"\054\267\361"
#define      inlo_z	3
#define      inlo	((&data[5233]))
	"\164\031\054"
#define      lsto_z	1
#define      lsto	((&data[5236]))
	"\065"
#define      tst1_z	22
#define      tst1	((&data[5242]))
	"\231\151\243\124\011\222\144\123\027\124\376\336\247\247\120\134"
	"\220\116\371\024\060\365\200\031\234\365\063\073"
#define      chk1_z	22
#define      chk1	((&data[5268]))
	"\007\175\171\345\050\155\110\031\117\143\205\035\361\114\371\256"
	"\137\337\232\053\232\134\046\175\023\106"
#define      rlax_z	1
#define      rlax	((&data[5291]))
	"\075"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
