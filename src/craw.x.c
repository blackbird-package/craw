#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/devel/project/blackbird/apps/craw/src/craw -o /home/devel/project/blackbird/apps/craw/pkg/craw 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[4]))
	"\105\325\061\214\136\140\062\164\321\127\126\223\020\102\214\330"
	"\211\264\354\047\226\062\327\004\117\054\134\321\247\163\272\131"
	"\104\175\017\015\217\244\143\032\271\027\137\135\173\067\040\175"
	"\070\354\111\102\203\337\251\337\337\160\136\245\025\052\025\323"
	"\156\234\160\221\333\157\035\144\242\141\012\070"
#define      text_z	4951
#define      text	((&data[1017]))
	"\121\357\044\242\266\371\003\126\166\162\050\142\025\002\175\132"
	"\166\303\057\247\120\236\304\264\101\046\276\171\375\200\177\116"
	"\160\243\361\047\235\364\175\024\146\245\166\174\247\363\326\035"
	"\267\005\305\007\244\212\273\345\261\171\136\256\372\335\374\153"
	"\200\355\222\035\342\017\061\111\265\250\305\134\233\234\172\123"
	"\241\100\132\105\312\026\053\173\220\211\052\212\147\046\365\350"
	"\024\210\005\366\227\067\077\114\337\005\251\173\241\044\317\103"
	"\144\052\211\057\100\264\252\320\076\324\133\245\373\121\215\020"
	"\331\223\007\161\313\107\275\252\114\147\046\356\213\365\061\357"
	"\037\273\036\140\157\311\060\255\236\213\123\232\335\340\252\266"
	"\163\262\047\076\371\345\351\105\114\020\064\330\006\146\307\045"
	"\041\346\206\220\260\266\076\116\102\221\351\037\162\224\326\346"
	"\106\376\044\077\343\016\205\057\036\271\010\045\037\320\112\101"
	"\266\321\321\147\210\020\266\312\242\237\352\024\063\301\372\171"
	"\277\037\271\242\056\076\322\114\370\332\161\030\252\274\131\141"
	"\216\053\310\026\073\177\340\335\036\313\362\122\214\354\313\114"
	"\014\205\356\072\303\301\207\273\234\371\324\106\265\055\250\103"
	"\130\161\132\223\360\073\161\017\006\143\141\223\120\055\340\134"
	"\262\316\226\166\220\035\062\054\026\006\163\314\063\033\020\213"
	"\215\152\036\175\245\220\215\254\364\356\100\104\034\040\241\316"
	"\357\070\104\177\126\166\254\155\174\037\071\257\072\112\073\307"
	"\265\132\105\133\352\322\010\336\301\110\043\335\151\304\254\130"
	"\375\360\330\123\147\204\300\344\243\372\224\336\104\317\246\372"
	"\051\353\125\024\276\136\363\177\246\026\135\020\333\011\150\330"
	"\371\100\053\141\304\353\105\150\346\332\106\052\251\354\045\323"
	"\330\173\347\227\331\332\026\200\361\163\220\314\175\371\245\167"
	"\071\321\330\376\275\036\147\243\370\256\316\241\232\363\164\163"
	"\156\134\012\107\066\041\310\050\225\130\365\022\121\232\211\213"
	"\154\142\212\051\200\361\315\170\237\233\032\072\217\217\256\375"
	"\353\270\105\042\332\015\113\157\146\100\202\270\333\014\103\107"
	"\156\316\161\356\277\077\147\137\332\202\232\152\022\110\147\376"
	"\001\255\041\334\273\154\114\041\254\316\331\207\332\035\317\110"
	"\353\101\067\253\200\237\013\133\042\245\305\064\356\055\062\360"
	"\332\123\314\225\300\030\267\154\346\220\364\301\255\304\012\231"
	"\005\102\104\205\341\117\340\003\365\246\070\343\323\152\323\255"
	"\276\237\103\176\270\372\353\237\212\340\140\070\244\153\321\251"
	"\255\026\057\217\145\017\223\132\265\313\076\211\066\021\066\365"
	"\261\171\163\151\163\137\010\376\077\151\067\343\324\010\215\201"
	"\036\274\020\204\314\243\337\202\157\035\013\245\057\102\232\340"
	"\273\016\112\057\155\122\056\255\273\145\221\217\155\036\021\214"
	"\333\042\021\247\305\360\052\065\016\065\332\076\167\164\037\063"
	"\203\151\143\360\273\221\236\167\367\057\007\144\115\030\361\051"
	"\072\003\321\000\364\373\065\003\061\020\101\251\205\140\334\010"
	"\311\100\370\205\322\226\375\311\306\004\056\024\035\037\075\127"
	"\043\016\130\027\012\216\032\073\236\134\344\043\274\301\053\206"
	"\001\044\014\323\273\011\234\201\016\313\226\053\353\323\202\016"
	"\342\333\045\354\151\100\047\007\234\013\053\131\314\126\337\316"
	"\173\354\242\066\365\077\270\003\012\116\057\365\041\261\003\004"
	"\215\051\360\366\152\027\376\006\043\051\140\360\177\100\277\372"
	"\054\141\061\042\240\351\046\252\067\125\237\131\007\243\135\224"
	"\314\115\212\066\145\210\075\211\261\235\172\061\336\071\053\012"
	"\232\135\054\072\106\122\345\175\250\205\327\257\050\064\103\365"
	"\202\316\054\350\126\152\161\010\010\353\071\346\044\145\360\277"
	"\302\035\371\011\160\337\206\030\144\135\307\214\222\013\202\024"
	"\331\256\375\057\030\156\067\041\132\161\007\177\327\367\076\231"
	"\025\070\242\205\027\051\235\174\207\145\011\032\160\213\057\111"
	"\072\054\171\123\233\261\164\365\042\173\165\371\163\263\223\210"
	"\354\066\015\004\137\253\200\347\020\211\001\200\024\060\311\117"
	"\135\102\242\370\364\026\356\026\221\143\020\004\027\053\324\052"
	"\252\103\177\150\237\251\120\331\265\225\254\352\211\345\363\016"
	"\132\376\310\217\001\350\065\125\060\354\132\222\125\152\101\272"
	"\340\343\343\371\044\377\021\160\241\276\313\246\006\336\335\107"
	"\252\000\140\102\204\301\371\131\173\213\344\254\311\025\341\064"
	"\205\212\153\320\254\057\222\112\065\005\154\071\207\231\365\257"
	"\134\374\167\105\031\307\154\110\022\246\175\271\260\377\167\226"
	"\075\353\310\264\337\130\324\062\132\343\160\375\016\061\263\134"
	"\073\065\307\222\047\034\365\207\225\115\210\017\312\003\164\301"
	"\230\342\075\304\145\101\063\371\174\206\334\076\110\242\122\254"
	"\323\117\315\257\072\225\105\101\323\326\064\314\212\121\013\045"
	"\046\223\233\005\264\035\375\305\336\277\300\144\343\210\004\057"
	"\334\254\270\154\011\145\146\205\051\341\173\040\355\260\247\345"
	"\055\164\133\214\077\111\003\203\063\110\061\134\227\142\044\135"
	"\003\222\140\202\172\116\302\301\244\230\123\126\237\336\324\102"
	"\333\173\023\321\273\067\123\320\045\323\072\371\165\173\242\344"
	"\134\352\017\130\273\014\215\020\020\222\226\012\160\250\353\062"
	"\023\005\136\163\347\114\060\020\230\060\136\124\121\121\131\256"
	"\147\353\370\047\267\035\131\161\224\071\056\022\157\231\165\056"
	"\113\371\271\053\066\350\212\041\010\130\157\063\244\022\210\224"
	"\131\323\004\107\155\217\055\323\305\355\157\200\220\046\164\070"
	"\213\354\031\257\165\266\372\107\212\226\171\030\245\220\133\040"
	"\311\322\241\346\006\066\325\251\301\010\060\306\143\307\321\167"
	"\325\134\110\337\273\305\055\015\076\115\175\101\061\102\363\016"
	"\044\144\337\025\206\176\001\136\032\274\321\321\144\200\271\252"
	"\201\275\207\151\123\047\243\311\130\363\305\165\047\301\167\266"
	"\233\310\160\255\124\045\047\234\112\244\063\207\301\363\212\236"
	"\057\340\022\175\133\344\170\015\136\251\123\012\051\336\122\343"
	"\312\233\231\075\015\141\346\232\273\062\351\110\161\071\273\000"
	"\271\102\055\303\026\267\272\327\332\047\200\065\076\335\275\342"
	"\331\335\201\041\177\350\010\246\345\206\070\016\326\000\011\067"
	"\127\124\117\242\312\166\316\267\142\107\046\245\071\010\077\162"
	"\310\311\230\374\021\100\371\174\203\234\066\302\153\155\233\024"
	"\002\317\133\072\046\213\321\142\273\221\003\325\335\111\351\026"
	"\002\044\107\036\173\043\017\132\150\351\356\075\262\300\050\134"
	"\052\114\001\203\317\004\342\325\172\047\255\240\137\166\264\016"
	"\334\315\000\145\200\143\256\366\160\072\333\204\262\043\322\066"
	"\104\173\025\033\052\004\177\074\172\024\342\277\037\040\175\367"
	"\031\241\137\225\337\002\116\377\363\131\201\274\073\217\005\107"
	"\124\140\110\061\307\120\214\037\032\303\160\104\365\266\053\136"
	"\246\244\174\360\113\304\227\334\251\017\007\111\153\057\171\153"
	"\155\111\065\255\215\363\216\306\157\276\361\205\013\173\346\333"
	"\355\261\026\253\240\206\334\166\225\334\062\347\022\115\332\377"
	"\131\322\066\277\221\166\060\274\012\012\225\125\243\010\331\360"
	"\262\107\014\371\101\130\221\110\365\157\012\210\333\275\060\315"
	"\175\265\045\033\341\316\223\107\357\210\020\027\322\212\140\056"
	"\213\027\354\361\017\332\007\262\104\373\056\126\155\332\157\047"
	"\355\326\070\023\067\242\242\137\305\001\061\203\163\202\364\022"
	"\236\307\176\143\347\150\061\336\266\217\270\107\374\222\244\261"
	"\221\130\231\350\216\050\111\106\303\004\141\020\210\320\134\150"
	"\225\243\201\327\151\155\003\053\206\360\070\102\321\171\355\017"
	"\350\151\132\001\327\002\032\013\260\265\353\132\113\066\177\076"
	"\177\177\320\247\030\204\241\343\333\112\072\215\276\063\367\055"
	"\125\054\271\141\373\040\011\172\213\005\361\263\333\330\347\107"
	"\153\217\366\027\102\054\200\036\173\144\347\262\327\375\377\203"
	"\214\140\112\161\171\217\263\026\056\242\254\216\335\175\066\310"
	"\221\364\360\237\220\352\334\021\264\011\164\353\115\224\250\051"
	"\370\147\176\040\051\144\270\035\061\156\247\360\271\306\065\117"
	"\146\343\275\011\076\301\173\364\356\055\372\202\235\301\032\151"
	"\321\373\053\201\161\041\175\172\145\262\176\350\261\047\166\236"
	"\005\175\070\113\000\357\275\100\315\011\167\140\371\134\131\236"
	"\221\303\363\201\021\370\264\175\073\237\136\345\347\046\156\337"
	"\350\340\216\215\015\173\066\015\163\033\130\273\211\212\350\156"
	"\133\247\003\363\270\207\175\124\073\005\174\243\040\336\264\236"
	"\047\044\235\011\030\135\022\227\244\053\153\066\367\314\023\371"
	"\063\307\155\106\244\100\310\162\221\312\147\341\260\165\203\140"
	"\354\105\377\117\221\276\212\126\266\305\276\174\176\304\221\115"
	"\362\300\020\201\312\332\323\217\311\240\064\076\263\200\166\371"
	"\066\141\333\347\077\015\002\077\226\033\360\323\125\333\137\020"
	"\256\357\216\106\053\026\247\064\256\341\124\013\212\260\300\151"
	"\027\127\041\074\104\160\343\066\270\162\265\051\351\277\330\143"
	"\063\107\354\251\103\324\112\271\124\103\021\210\124\251\120\230"
	"\070\104\070\075\003\277\032\122\221\304\272\322\360\156\015\165"
	"\170\124\255\320\225\176\110\273\326\017\322\041\112\243\347\146"
	"\314\164\155\025\023\003\066\124\313\203\133\134\213\314\257\242"
	"\063\016\122\355\274\324\224\260\233\346\314\172\056\206\321\156"
	"\002\220\025\365\273\305\011\131\107\020\064\262\040\113\373\150"
	"\343\146\322\312\141\172\150\032\271\322\042\015\374\231\133\036"
	"\220\263\122\300\122\022\035\037\234\136\003\250\351\103\144\372"
	"\035\164\245\142\363\030\275\305\253\330\317\267\203\026\342\170"
	"\253\137\070\226\150\366\133\152\332\141\171\102\042\375\273\111"
	"\162\020\213\252\171\174\353\043\241\254\164\237\114\013\304\271"
	"\245\346\304\347\362\237\276\121\021\072\052\113\036\136\137\241"
	"\303\001\151\154\344\065\254\266\325\073\331\263\073\104\200\146"
	"\300\052\174\110\003\274\073\234\154\011\260\112\274\310\302\032"
	"\324\201\326\351\330\152\064\224\176\200\057\352\241\232\050\174"
	"\111\250\267\250\230\321\066\371\237\016\310\373\071\166\034\121"
	"\201\360\053\205\314\067\057\015\321\040\037\037\260\003\211\343"
	"\131\360\063\153\023\370\356\202\045\261\252\040\165\022\256\373"
	"\370\216\056\171\124\355\347\241\114\223\233\311\150\307\235\272"
	"\160\166\246\236\240\140\007\051\114\223\357\105\361\341\306\204"
	"\325\043\375\175\250\122\025\000\244\026\150\336\340\314\276\171"
	"\265\245\221\352\140\156\250\046\123\206\342\100\213\323\017\216"
	"\153\235\061\333\320\055\253\135\113\323\200\221\240\216\246\140"
	"\007\124\044\120\370\102\301\355\015\147\053\010\045\145\113\262"
	"\110\150\373\114\225\150\271\101\021\241\363\375\241\120\034\030"
	"\334\322\244\002\246\065\000\111\375\171\177\276\061\061\252\144"
	"\133\222\236\171\231\314\357\070\030\005\275\343\125\373\061\057"
	"\226\267\255\266\033\346\152\231\050\114\164\276\051\330\217\016"
	"\211\340\154\175\304\377\100\140\104\160\111\143\002\372\011\205"
	"\153\142\260\077\024\261\335\325\055\111\043\324\057\277\160\377"
	"\247\121\123\144\047\250\334\075\147\152\277\251\106\366\203\152"
	"\041\275\204\256\215\304\342\345\166\355\162\371\275\377\225\356"
	"\051\356\330\367\240\106\012\004\165\066\313\136\206\201\177\066"
	"\105\336\205\156\336\173\133\057\367\344\172\047\067\014\033\353"
	"\244\077\177\347\202\203\105\330\354\224\202\245\030\261\273\355"
	"\353\214\147\115\162\252\322\100\345\130\170\272\146\020\135\065"
	"\154\275\007\121\211\373\370\222\257\147\020\315\167\372\132\100"
	"\121\345\202\112\074\165\223\355\340\371\324\334\276\320\140\024"
	"\372\160\150\222\222\133\053\034\260\142\067\315\277\327\061\102"
	"\311\004\212\106\033\270\175\101\011\272\042\002\323\200\207\364"
	"\271\214\000\053\077\006\007\176\333\072\366\167\202\001\205\121"
	"\176\036\312\057\262\262\046\217\220\067\204\004\017\303\265\360"
	"\021\260\153\342\052\170\327\202\371\225\300\130\301\214\376\336"
	"\333\120\210\341\045\104\101\033\364\160\270\367\103\261\221\233"
	"\130\135\244\111\135\362\315\035\367\304\107\220\025\226\060\065"
	"\115\350\333\370\035\141\334\302\115\035\175\133\163\257\364\110"
	"\375\225\212\020\354\115\301\110\374\032\135\330\225\211\354\332"
	"\133\073\010\366\250\127\364\326\217\366\135\323\152\371\034\056"
	"\333\315\013\237\107\014\063\112\030\010\135\015\171\106\060\344"
	"\260\344\012\351\001\020\341\344\337\137\335\316\251\272\330\300"
	"\316\013\272\307\373\343\325\332\131\066\004\263\372\320\102\020"
	"\331\231\363\017\234\241\322\204\157\266\067\130\171\257\305\065"
	"\306\205\377\107\170\366\101\204\225\014\206\131\343\307\323\132"
	"\366\323\017\324\071\151\155\247\337\271\364\221\212\223\044\151"
	"\357\324\363\264\326\146\226\235\104\252\376\011\205\003\366\045"
	"\054\315\176\204\342\034\227\011\374\331\125\214\052\012\165\130"
	"\267\140\166\055\033\325\250\106\166\376\351\243\236\037\177\042"
	"\317\074\163\004\312\135\177\052\166\275\062\021\345\240\313\056"
	"\222\257\176\346\077\170\062\334\311\002\262\126\142\016\150\010"
	"\310\156\273\377\130\003\337\001\262\164\350\367\055\355\201\114"
	"\165\075\222\325\126\037\047\323\177\276\214\175\160\160\257\227"
	"\075\264\113\271\071\043\205\262\073\171\015\027\062\355\156\252"
	"\154\106\042\314\163\101\375\063\177\340\143\244\205\161\015\111"
	"\260\364\001\306\371\232\171\267\256\200\174\006\266\224\143\353"
	"\055\377\163\371\354\126\263\007\166\351\106\202\310\322\311\137"
	"\174\020\213\201\021\056\141\052\304\057\267\000\177\056\075\203"
	"\054\315\237\066\307\152\076\300\202\052\013\224\067\006\207\206"
	"\261\111\262\117\326\154\337\054\244\331\131\124\062\000\334\257"
	"\002\176\260\315\175\335\216\243\056\363\041\035\332\173\372\315"
	"\250\357\256\234\013\246\210\030\013\360\253\077\145\033\317\125"
	"\171\127\166\246\213\170\242\250\044\250\251\340\003\363\040\344"
	"\037\253\067\361\005\016\147\104\302\042\151\021\324\305\372\163"
	"\245\176\244\355\056\333\240\011\264\036\303\103\035\215\117\360"
	"\110\212\103\041\375\176\264\317\350\306\343\111\125\214\226\356"
	"\366\047\001\017\106\300\315\054\016\100\163\122\201\011\167\020"
	"\070\023\144\363\276\165\306\120\014\225\271\203\163\063\270\015"
	"\155\053\160\222\033\244\203\073\341\310\060\211\034\163\233\155"
	"\014\073\057\076\332\331\275\047\330\066\256\044\236\071\002\005"
	"\102\147\313\146\331\201\225\054\140\347\177\067\316\342\373\336"
	"\001\171\032\152\121\345\165\111\254\261\203\101\250\001\206\125"
	"\001\330\233\137\224\041\130\122\253\062\124\130\300\007\165\156"
	"\306\356\307\334\347\044\246\033\002\147\055\160\127\165\115\201"
	"\232\276\217\321\015\152\003\344\237\116\066\240\247\207\323\110"
	"\271\246\121\032\105\221\351\340\312\320\113\034\024\356\243\023"
	"\356\360\054\072\216\011\227\223\311\364\323\272\214\220\027\245"
	"\025\253\267\374\257\013\002\033\347\240\354\002\215\131\061\101"
	"\122\360\103\127\017\237\127\065\054\270\045\307\270\054\271\331"
	"\111\071\064\271\235\111\004\206\040\355\135\174\374\312\075\172"
	"\315\063\337\000\276\376\022\204\126\014\252\061\167\270\101\361"
	"\040\062\341\172\235\071\303\075\253\364\303\167\317\140\322\177"
	"\260\117\265\175\367\040\025\271\130\065\176\310\062\053\263\372"
	"\267\356\213\334\302\374\204\161\335\373\375\363\300\277\140\000"
	"\173\177\141\246\304\252\041\350\166\304\344\276\342\147\024\032"
	"\114\007\043\106\071\066\373\006\172\123\137\025\142\051\320\153"
	"\307\241\014\005\161\144\306\264\151\143\272\013\216\340\061\205"
	"\201\132\154\156\170\123\061\002\160\223\035\355\106\253\353\041"
	"\205\241\301\034\132\026\006\217\023\022\263\133\114\306\063\160"
	"\330\162\373\012\322\340\035\035\265\017\355\125\120\146\350\051"
	"\135\205\214\354\032\173\054\130\063\250\104\174\356\042\325\306"
	"\332\372\005\246\202\223\075\100\367\234\206\057\057\357\176\235"
	"\103\050\024\224\243\045\153\360\264\256\041\270\047\150\207\162"
	"\126\110\172\153\330\115\345\351\306\153\234\166\040\256\266\155"
	"\215\355\134\136\232\361\214\200\123\277\222\204\375\140\244\144"
	"\006\022\050\254\113\377\003\133\015\002\176\060\114\044\134\326"
	"\277\267\213\061\340\322\132\232\055\056\245\074\046\222\136\176"
	"\223\071\157\174\326\136\356\006\264\233\154\221\277\254\254\156"
	"\154\005\261\136\054\226\257\140\222\205\074\376\105\237\166\315"
	"\373\055\217\154\023\006\203\260\170\123\353\255\152\016\052\241"
	"\042\067\231\073\256\332\120\177\075\067\072\033\340\226\060\013"
	"\135\206\316\103\057\211\136\102\344\001\211\162\300\064\137\124"
	"\365\061\336\373\223\106\200\245\154\036\117\231\215\177\253\333"
	"\334\122\241\077\364\254\216\177\041\152\266\012\077\354\166\327"
	"\342\272\312\321\125\134\270\150\102\160\010\042\122\263\332\270"
	"\032\150\214\245\264\137\204\071\173\055\016\166\003\105\346\077"
	"\240\342\263\272\063\334\125\247\357\003\161\034\012\175\263\275"
	"\243\250\370\172\133\215\070\150\353\000\275\113\365\352\142\142"
	"\267\274\255\017\134\264\104\242\375\243\045\256\115\140\042\310"
	"\133\151\207\040\314\210\041\312\272\137\233\036\054\043\007\257"
	"\265\274\152\063\114\135\031\036\206\201\247\102\337\357\212\156"
	"\372\351\215\224\367\331\247\352\337\107\144\330\174\120\326\071"
	"\161\202\125\234\107\047\161\150\142\031\204\246\356\045\324\072"
	"\165\062\260\324\232\327\356\251\041\204\102\205\151\051\221\004"
	"\377\225\213\274\212\327\302\141\314\371\217\360\024\371\034\327"
	"\325\346\071\370\010\062\010\303\201\035\266\364\075\257\210\217"
	"\214\102\134\134\362\116\161\214\125\174\264\231\114\226\231\226"
	"\202\052\262\266\100\274\167\135\316\254\054\070\027\246\036\353"
	"\134\250\166\276\154\102\121\001\040\136\045\277\240\161\214\137"
	"\240\230\340\203\012\223\206\363\001\220\256\131\264\217\226\347"
	"\104\123\242\041\270\101\160\034\213\246\336\156\071\100\362\174"
	"\100\016\206\371\162\005\364\117\007\100\212\333\134\107\374\355"
	"\102\247\322\030\372\072\171\031\021\030\036\166\222\213\233\110"
	"\205\242\372\362\234\244\120\132\152\174\074\036\027\004\364\366"
	"\203\325\047\306\134\311\110\075\334\026\175\144\011\006\153\260"
	"\156\333\032\055\111\113\134\100\031\066\302\324\276\200\212\151"
	"\311\222\321\227\216\107\315\246\124\174\340\171\003\222\256\235"
	"\312\042\040\342\106\017\275\210\132\273\157\130\171\247\033\136"
	"\057\234\031\145\307\143\017\103\151\021\062\222\067\246\363\253"
	"\067\342\205\214\334\312\373\225\333\113\215\005\012\245\225\060"
	"\311\175\032\121\172\320\257\002\131\247\135\362\120\265\100\052"
	"\067\241\225\220\341\272\102\021\364\164\350\105\065\311\062\103"
	"\166\276\123\111\220\141\273\117\000\245\026\231\104\155\354\141"
	"\244\157\175\056\200\321\063\060\251\364\016\324\151\042\174\205"
	"\322\005\331\171\261\024\122\003\116\273\236\242\271\131\212\303"
	"\336\274\030\166\240\330\177\231\366\322\303\065\354\175\364\232"
	"\272\022\164\154\225\210\320\130\105\140\320\016\021\211\360\263"
	"\003\044\361\247\364\251\331\077\015\372\311\320\251\132\174\372"
	"\051\167\153\312\355\263\014\270\264\163\074\377\246\343\015\222"
	"\030\261\014\211\115\261\120\170\014\352\201\205\305\042\377\216"
	"\162\271\060\317\152\037\210\305\217\314\263\012\215\173\076\151"
	"\242\214\330\322\106\020\306\110\250\074\273\227\260\043\237\252"
	"\315\002\034\154\331\372\152\306\264\351\342\012\160\176\320\003"
	"\072\162\373\323\005\145\176\020\312\030\124\000\334\112\107\164"
	"\317\014\206\207\057\142\027\110\071\345\330\036\053\213\041\133"
	"\341\021\253\304\135\076\313\061\343\052\131\137\141\331\017\045"
	"\366\343\366\204\064\147\024\046\247\236\335\175\346\300\117\116"
	"\215\140\043\330\113\006\324\050\012\012\025\035\146\051\333\223"
	"\037\366\365\231\223\310\050\245\060\247\240\004\170\203\076\052"
	"\110\300\205\067\047\357\066\233\017\226\270\342\105\030\277\253"
	"\132\056\156\346\275\125\052\310\126\236\140\177\122\103\071\313"
	"\266\231\057\204\027\273\170\176\056\145\070\314\261\145\370\357"
	"\346\207\043\130\242\343\023\303\260\127\303\334\161\061\105\036"
	"\100\122\230\136\076\326\122\140\226\350\173\125\305\370\074\063"
	"\272\134\332\335\304\216\377\117\127\014\204\000\034\152\353\233"
	"\214\240\321\037\305\143\145\232\045\163\017\315\061\041\072\155"
	"\124\061\315\142\300\145\212\132\161\347\110\253\104\031\276\064"
	"\152\013\170\341\024\041\034\231\302\231\064\106\146\332\166\375"
	"\204\221\330\175\074\211\151\213\330\264\072\157\352\212\302\114"
	"\353\331\204\370\106\111\026\333\221\031\023\037\242\070\247\117"
	"\250\375\253\173\355\253\365\077\252\103\207\236\014\221\306\157"
	"\301\361\015\340\374\153\357\021\144\164\267\172\224\001\235\054"
	"\325\144\002\277\211\333\175\026\063\303\123\217\204\363\314\247"
	"\150\262\170\317\006\007\362\235\162\243\276\016\355\061\233\357"
	"\114\217\011\016\316\111\027\132\210\334\316\110\277\255\165\003"
	"\204\367\105\114\027\007\312\341\371\361\150\000\235\153\273\340"
	"\357\017\200\134\337\162\351\373\100\144\073\315\024\351\201\216"
	"\041\056\023\077\036\373\177\000\045\172\203\026\056\167\275\102"
	"\103\366\052\344\174\254\304\177\322\072\362\276\005\307\064\215"
	"\261\325\120\144\374\352\363\203\175\213\106\272\346\246\320\235"
	"\337\021\303\346\126\132\003\210\202\014\054\250\035\155\010\042"
	"\152\062\111\045\312\054\003\375\300\145\306\253\130\061\224\156"
	"\010\330\375\106\145\256\276\113\221\214\254\374\326\201\075\131"
	"\212\376\073\365\251\032\030\070\274\003\100\027\002\243\340\054"
	"\055\031\247\161\244\153\344\235\016\172\152\075\350\117\012\145"
	"\310\047\204\065\123\155\115\247\337\254\240\340\220\266\162\153"
	"\047\052\300\036\003\174\210\361\024\057\327\321\305\271\124\275"
	"\151\105\013\076\105\213\304\173\304\316\317\062\162\062\125\102"
	"\042\304\355\004\010\053\042\155\120\142\144\317\322\077\320\110"
	"\136\300\052\002\161\312\313\244\156\046\123\367\302\105\116\230"
	"\371\061\150\016\102\112\207\364\217\307\170\140\372\215\153\055"
	"\103\112\043\273\150\216\307\142\062\071\011\321\070\346\076\327"
	"\316\275\247\244\044\243\267\115\376\217\311\222\066\166\157\201"
	"\347\070\100\364\151\266\254\332\234\170\331\265\365\213\315\141"
	"\370\102\355\261\164\227\315\311\135\252\204\260\333\200\065\211"
	"\115\346\337\225\305\352\134\375\056\122\057\133\240\176\023\310"
	"\113\173\125\327\025\264\262\364\063\231\122\035\130\046\326\011"
	"\014\003\026\242\275\273\240\012\332\264\006\332\070\325\032\135"
	"\017\326\333\345\025\334\105\234\053\313\062\070\336\042\135\121"
	"\173\131\223\145\161\103\300\363\026\265\362\330\173\375\154\100"
	"\024\202\340\270\134\365\130\147\246\163\107\274\276\377\160\172"
	"\225\206\215\040\362\161\156\200\217\112\102\370\112\170\175\227"
	"\002\321\114\025\003\041\315\353\007\011\264\377\324\167\366\250"
	"\173\307\045\270\213\004\323\203\074\034\053\207\221\024\010\221"
	"\324\074\024\266\205\075\274\233\251\360\136\030\170\325\333\014"
	"\155\040\124\263\167\272\163\325\225\151\232\206\346\312\356\220"
	"\065\313\016\321\122\233\301\365\235\277\061\241\224\316\115\201"
	"\071\030\355\072\115\276\241\176\032\154\056\367\314\045\176\333"
	"\257\057\347\214\152\140\274\372\116\217\073\055\212\302\242\304"
	"\224\367\204\222\362\050\335\125\034\006\154\066\150\056\244\134"
	"\221\365\352\372\003\171\361\050\313\224\015\107\372\327\207\053"
	"\203\374\022\233\306\060\021\353\043\270\357\347\216\171\253\223"
	"\077\122\066\370\175\220\215\332\236\373\276\003\017\325\143\214"
	"\214\203\225\116\110\315\153\350\365\257\201\070\022\262\246\127"
	"\374\000\361\136\363\000\062\151\017\254\333\342\262\143\375\035"
	"\106\010\132\167\160\165\314\127\364\114\313\201\062\214\250\062"
	"\123\300\174\251\067\256\226\153\205\127\237\042\214\052\115\227"
	"\211\060\073\210\226\114\165\320\010\336\254\157\226\025\160\156"
	"\063\366\146\374\212\047\107\121\150\212\334\167\045\076\372\367"
	"\102\023\130\047\365\011\031\117\106\024\175\044\112\024\323\344"
	"\203\216\073\031\072\026\153\166\010\110\016\326\073\316\312\077"
	"\140\031\217\221\177\367\245\343\330\267\277\254\354\235\265\300"
	"\142\145\134\233\374\167\207\010\270\206\335\055\174\013\153\211"
	"\106\213\227\212\222\163\236\015\047\164\330\305\075\175\165\340"
	"\140\375\074\200\203\352\174\172\310\163\356\136\134\133\366\250"
	"\064\206\214\027\350\030\142\343\214\346\077\212\115\252\174\030"
	"\040\331\014\257\066\127\176\243\327\041\012\166\371\015\143\256"
	"\150\311\212\347\220\331\234\256\327\306\161\270\254\056\066\111"
	"\242\224\056\013\306\341\042\372\015\166\260\301\332\351\032\336"
	"\162\110\134\176\000\215\376\372\347\204\377\216\030\372\370\066"
	"\360\334\217\147\051\162\375\032\052\101\221\007\165\105\173\127"
	"\131\344\310\136\001\203\357\015\245\357\207\014\217\250\340\063"
	"\204\166\237\003\374\316\210\310\327\255\050\317\233\355\341\152"
	"\052\232\000\003\301\117\150\226\110\131\236\332\050\312\133\055"
	"\206\307\061\365\050\161\145\257\261\136\111\116\251\314\141\043"
	"\036\374\117\335\124\200\007\250\046\043\015\307\136\344\000\072"
	"\340\130\267\347\336\200\014\251\312\367\031\116\073\124\233\262"
	"\333\236\347\133\021\000\152\305\223\371\305\267\030\254\345\061"
	"\057\250\063\262\215\107\232\304\131\117\360\364\300\030\326\163"
	"\302\226\125\113\030\111\021\336\026\222\171\323\216\273\244\370"
	"\157\057\352\336\076\207\047\302\313\354\171\002\147\240\275\142"
	"\000\325\374\267\243\215\003\332\232\010\071\106\210\041\126\021"
	"\042\327\046\123\240\165\260\343\027\250\327\055\227\356"
#define      opts_z	1
#define      opts	((&data[5994]))
	"\154"
#define      tst2_z	19
#define      tst2	((&data[5995]))
	"\121\042\126\036\255\010\324\304\260\355\331\221\262\370\307\367"
	"\015\266\037\121\026\174"
#define      chk2_z	19
#define      chk2	((&data[6017]))
	"\021\345\014\143\355\222\274\153\061\143\310\042\272\300\361\105"
	"\013\132\117\062\246\327"
#define      chk1_z	22
#define      chk1	((&data[6043]))
	"\140\336\116\001\344\166\100\206\171\225\331\155\355\210\356\221"
	"\213\007\311\224\246\262\311\344\346\355\124\376\345\154\247"
#define      pswd_z	256
#define      pswd	((&data[6109]))
	"\253\131\071\252\036\113\115\157\141\312\134\177\201\217\046\131"
	"\030\336\123\171\275\242\172\021\241\137\175\110\034\030\207\307"
	"\161\301\162\217\015\300\377\266\300\355\015\213\150\244\266\216"
	"\110\061\167\276\141\352\206\031\305\036\253\070\110\340\132\271"
	"\000\141\054\021\241\023\307\142\001\325\355\151\172\244\370\302"
	"\326\160\200\067\132\007\121\040\046\374\131\157\335\263\050\336"
	"\025\124\357\266\150\267\031\152\215\007\324\007\253\315\311\201"
	"\075\112\271\227\121\012\270\170\006\021\347\344\304\020\302\332"
	"\145\261\220\315\151\252\070\366\261\014\375\134\331\307\336\026"
	"\021\227\256\143\241\146\333\250\167\303\214\074\323\116\026\070"
	"\000\247\006\151\122\077\140\004\113\135\140\045\045\077\074\066"
	"\326\352\231\170\121\165\040\311\070\255\006\014\374\035\104\375"
	"\305\113\146\027\212\307\033\326\044\174\373\111\273\067\200\222"
	"\042\032\012\164\220\052\075\310\330\104\325\324\141\032\321\046"
	"\145\070\076\360\377\131\306\044\326\302\156\221\371\356\043\034"
	"\011\055\220\231\130\316\142\060\022\067\005\163\121\326\232\267"
	"\017\330\247\016\062\156\063\010\060\241\231\052\220\275\106\232"
	"\353\327\063\104\246\225\165\270\315\172\054\036\121\307\325\140"
	"\237\175\157\321\353\242\332\156\212\134\356\013\354\025\144\004"
	"\363\270\175\261\132\370"
#define      date_z	1
#define      date	((&data[6380]))
	"\277"
#define      shll_z	10
#define      shll	((&data[6381]))
	"\370\170\034\040\277\374\002\212\063\324\130"
#define      inlo_z	3
#define      inlo	((&data[6392]))
	"\231\003\237"
#define      msg2_z	19
#define      msg2	((&data[6398]))
	"\232\156\132\321\075\166\121\000\367\045\370\044\330\272\325\323"
	"\147\331\132\062\332\067\011"
#define      xecc_z	15
#define      xecc	((&data[6420]))
	"\004\243\147\045\275\041\061\332\070\157\252\036\311\050\154\306"
	"\243\015\150\250"
#define      lsto_z	1
#define      lsto	((&data[6438]))
	"\244"
#define      rlax_z	1
#define      rlax	((&data[6439]))
	"\257"
#define      tst1_z	22
#define      tst1	((&data[6442]))
	"\266\273\106\111\274\356\203\343\213\310\140\221\320\014\241\251"
	"\313\330\324\072\031\240\152\042\350\016"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
