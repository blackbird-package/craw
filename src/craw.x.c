#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/devel/project/blackbird/apps/craw/src/craw -o /home/devel/project/blackbird/apps/craw/pkg/craw 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[9]))
	"\362\166\264\313\126\231\222\215\206\205\051\361\067\011\330\214"
	"\027\152\240\051\362\230\100\377\142\144\073\125\175\205\165\023"
	"\040\160\041\066\016\261\360\105\010\064\201\053\142\257\103\201"
	"\370\225\070\002\175\152\233\343\146\107\215\021\206\015\276\170"
	"\136\272\315\377\213\147\262\030\324\213\147\041\075\100\047"
#define      inlo_z	3
#define      inlo	((&data[79]))
	"\115\160\031"
#define      chk2_z	19
#define      chk2	((&data[86]))
	"\005\225\367\022\202\361\355\133\102\173\267\203\331\145\200\252"
	"\370\220\105\230\342\316\140\117"
#define      pswd_z	256
#define      pswd	((&data[122]))
	"\017\313\047\001\101\333\315\230\165\137\046\374\307\107\071\007"
	"\020\317\320\135\347\252\301\377\216\000\073\362\012\130\166\216"
	"\046\060\303\377\126\217\347\360\174\273\333\222\166\353\005\206"
	"\273\325\344\243\200\246\242\016\246\336\001\261\066\170\100\135"
	"\251\003\134\377\223\103\360\017\376\313\241\164\267\247\373\162"
	"\175\340\026\375\206\270\014\055\226\015\337\315\205\037\052\056"
	"\042\207\056\266\312\036\305\311\352\147\076\241\016\072\024\213"
	"\032\052\211\241\343\225\316\171\242\256\107\050\315\162\126\360"
	"\371\204\246\304\243\154\215\215\323\314\057\342\006\104\156\040"
	"\157\367\302\122\214\221\314\057\077\023\127\014\205\255\375\177"
	"\062\244\103\326\020\321\144\343\235\223\306\243\327\064\304\107"
	"\053\206\231\270\027\146\347\127\172\077\144\000\355\141\177\040"
	"\005\302\366\026\224\132\371\061\356\277\325\306\364\232\015\037"
	"\041\247\330\071\015\300\220\207\377\364\210\355\126\007\015\134"
	"\312\004\162\136\137\154\220\115\054\146\023\040\000\040\100\042"
	"\307\031\133\325\331\353\135\331\340\345\306\067\354\324\223\267"
	"\330\005\025\067\162\245\205\236\014\230\277\014\271\377\056\201"
	"\157\214\177\010\206\174\100\213\021\067\235\141\055\336\061\075"
	"\252\131\077\353\065\014\204\252\154\252\246\063\362\340\072\141"
	"\155\271\152\363\065\252\177\107\341\034\250\017\373\332\114\246"
	"\063\214\221\150"
#define      chk1_z	22
#define      chk1	((&data[430]))
	"\174\211\350\332\257\373\111\002\334\157\023\144\345\233\166\374"
	"\227\243\230\010\113\246"
#define      date_z	1
#define      date	((&data[452]))
	"\300"
#define      shll_z	10
#define      shll	((&data[455]))
	"\163\025\326\320\317\205\312\074\352\372\212\107\010"
#define      xecc_z	15
#define      xecc	((&data[467]))
	"\143\216\033\337\220\060\143\026\153\276\351\247\271\036\056\025"
	"\052\173\252"
#define      lsto_z	1
#define      lsto	((&data[485]))
	"\071"
#define      tst1_z	22
#define      tst1	((&data[489]))
	"\150\072\141\325\163\102\072\057\356\336\127\166\136\224\247\367"
	"\372\123\301\113\256\031\262\353\143\364"
#define      opts_z	1
#define      opts	((&data[512]))
	"\361"
#define      tst2_z	19
#define      tst2	((&data[517]))
	"\243\230\312\127\176\202\320\026\123\041\172\262\373\032\121\040"
	"\025\346\253\315\315\267\343\063\075"
#define      msg2_z	19
#define      msg2	((&data[539]))
	"\354\335\316\007\254\334\155\057\230\047\144\151\076\377\362\326"
	"\350\024\214\044\070\316"
#define      rlax_z	1
#define      rlax	((&data[560]))
	"\222"
#define      text_z	4504
#define      text	((&data[895]))
	"\075\337\372\245\032\134\232\346\047\047\310\005\270\153\236\203"
	"\302\322\301\057\016\054\034\106\372\062\372\163\124\106\077\222"
	"\046\072\070\100\227\322\046\277\371\356\305\262\132\143\066\035"
	"\066\367\115\104\044\151\213\036\233\206\221\360\314\321\203\363"
	"\014\273\063\244\216\132\143\207\111\050\072\243\214\160\300\302"
	"\147\015\006\214\167\222\252\023\030\074\003\345\016\207\330\033"
	"\103\013\277\321\146\042\131\257\113\223\122\327\004\023\231\154"
	"\041\240\370\230\063\242\253\113\337\257\060\355\067\011\010\172"
	"\025\307\113\173\352\245\052\065\071\175\014\075\221\246\251\262"
	"\106\241\113\171\104\367\305\043\246\366\020\335\377\031\130\024"
	"\341\244\220\313\111\272\000\202\070\015\277\311\263\151\173\372"
	"\012\307\164\117\276\071\162\145\060\203\103\057\234\233\104\175"
	"\077\324\110\211\217\111\014\310\127\314\221\013\065\015\005\100"
	"\324\171\217\223\263\001\370\343\204\073\023\041\326\130\236\026"
	"\055\347\240\275\061\254\205\210\170\026\223\256\043\231\356\370"
	"\023\175\213\306\177\203\252\003\277\276\045\226\026\304\255\103"
	"\253\115\000\335\372\205\146\162\234\372\040\300\223\017\270\246"
	"\214\104\155\013\307\030\017\207\326\064\035\354\370\312\060\244"
	"\027\060\202\021\266\350\204\122\342\245\022\165\264\313\034\100"
	"\017\211\114\327\242\133\136\170\220\173\144\211\106\224\056\135"
	"\305\260\157\173\231\364\316\173\231\340\361\115\254\015\370\355"
	"\333\245\247\006\154\150\102\001\076\366\150\121\366\113\370\173"
	"\032\331\173\210\135\121\111\347\160\247\052\332\221\165\227\047"
	"\140\224\005\061\064\024\035\337\022\122\200\102\042\202\052\316"
	"\226\006\137\304\164\004\010\364\356\271\112\145\117\370\052\240"
	"\124\276\226\374\132\310\240\201\376\261\217\030\116\067\314\311"
	"\003\013\060\173\034\264\212\336\204\203\212\154\245\067\377\036"
	"\177\123\311\053\135\012\230\161\127\106\120\254\207\247\352\207"
	"\263\050\217\177\327\124\201\142\030\133\230\161\253\206\321\216"
	"\116\014\021\251\251\225\376\233\207\165\334\174\130\364\145\154"
	"\246\140\154\375\262\242\206\151\253\051\333\220\142\336\333\317"
	"\374\060\235\061\316\223\115\203\025\306\301\107\300\271\072\162"
	"\044\026\056\325\165\014\174\162\162\236\275\052\345\224\025\366"
	"\222\274\123\002\032\034\127\362\273\165\077\370\015\323\053\131"
	"\201\164\203\200\047\070\236\201\164\241\025\305\124\127\267\257"
	"\034\332\014\354\172\325\153\320\326\150\222\117\172\014\335\044"
	"\112\105\006\010\065\072\211\125\126\050\166\067\215\155\124\213"
	"\335\162\314\313\225\246\103\316\241\320\350\145\100\162\025\245"
	"\372\272\153\313\143\304\364\232\173\016\240\157\374\371\162\315"
	"\356\012\360\222\210\175\064\364\311\331\116\365\030\141\173\121"
	"\266\264\012\254\135\266\235\043\024\243\036\116\114\124\351\250"
	"\316\276\144\140\240\145\121\045\146\017\342\221\275\004\142\217"
	"\045\235\033\147\012\065\151\134\211\140\116\175\073\375\151\212"
	"\112\321\140\060\034\227\374\352\225\164\332\257\327\116\233\212"
	"\072\274\116\074\157\271\047\175\035\334\164\364\075\025\241\017"
	"\276\021\113\157\061\070\310\230\071\346\261\225\031\377\046\076"
	"\051\226\257\323\035\116\076\347\120\077\177\276\320\160\040\125"
	"\204\015\322\140\201\330\353\254\364\357\353\336\330\102\125\254"
	"\113\371\017\031\370\323\277\270\170\105\216\214\326\312\254\030"
	"\037\370\253\331\062\244\322\366\340\241\135\204\035\311\340\215"
	"\333\170\304\104\314\041\266\210\242\147\261\035\052\121\257\113"
	"\165\055\313\146\312\305\010\047\147\150\212\374\377\171\247\160"
	"\121\123\111\366\167\114\133\255\234\316\225\115\042\336\143\247"
	"\061\067\061\372\347\314\252\012\272\371\146\306\262\151\234\341"
	"\141\363\156\041\324\173\202\322\062\056\103\330\222\214\054\270"
	"\242\127\104\321\374\063\215\045\127\262\171\372\251\360\126\311"
	"\037\375\202\164\075\353\377\316\142\357\061\067\276\026\364\207"
	"\046\256\013\204\327\206\122\350\360\014\227\153\147\131\327\337"
	"\251\052\032\357\206\027\116\214\050\115\130\067\276\046\116\063"
	"\052\024\156\210\002\172\124\247\334\166\265\050\123\025\144\264"
	"\144\001\315\017\350\314\035\363\247\312\272\001\201\210\324\131"
	"\307\162\055\331\113\211\026\140\274\200\237\013\204\105\262\030"
	"\020\200\155\110\240\267\252\324\021\311\377\334\032\123\346\364"
	"\376\074\302\355\345\000\311\075\131\332\167\240\216\234\243\020"
	"\311\162\057\003\244\227\320\322\263\033\361\205\045\350\221\244"
	"\324\041\254\150\000\275\110\234\365\163\073\170\332\131\134\322"
	"\211\175\062\341\031\023\016\217\302\053\325\310\145\053\161\261"
	"\176\033\304\002\231\153\066\320\351\354\223\040\160\234\261\022"
	"\221\133\250\146\141\124\004\102\010\344\014\324\113\364\176\136"
	"\251\333\000\332\354\370\022\161\012\307\211\113\104\026\252\036"
	"\352\261\263\343\125\220\327\333\377\171\202\124\377\020\256\176"
	"\200\157\256\351\074\212\070\137\242\237\355\020\317\243\354\046"
	"\057\011\265\300\215\363\152\215\355\004\006\070\335\215\035\146"
	"\150\131\340\234\153\305\265\137\160\332\203\215\322\217\332\356"
	"\044\222\170\150\364\321\040\113\145\245\333\163\056\364\075\044"
	"\073\311\372\200\254\257\174\102\141\126\320\264\175\177\353\170"
	"\135\225\240\326\016\001\071\176\104\342\160\263\222\377\227\214"
	"\240\201\225\266\231\247\233\274\136\120\000\014\024\155\322\367"
	"\315\110\321\062\116\233\013\055\051\176\046\052\124\265\274\152"
	"\115\172\244\024\013\256\304\316\251\027\120\252\121\163\335\266"
	"\076\301\057\243\377\174\301\156\164\206\141\321\110\104\207\205"
	"\323\144\332\172\152\237\255\006\031\065\331\214\163\020\223\050"
	"\103\306\203\260\254\074\025\243\126\110\042\376\066\146\112\337"
	"\264\307\350\375\140\203\237\355\030\225\065\011\126\114\136\162"
	"\143\357\260\344\351\125\113\173\172\300\266\322\173\230\234\342"
	"\264\212\160\000\142\074\223\015\271\361\337\250\033\331\310\252"
	"\301\005\114\234\260\135\015\042\234\010\112\315\317\225\311\270"
	"\071\267\111\264\002\260\052\005\131\210\000\374\303\254\167\100"
	"\261\332\246\173\265\044\126\137\146\173\313\222\322\233\051\224"
	"\216\331\370\372\036\127\062\263\116\251\200\312\126\117\041\161"
	"\361\355\151\214\304\201\264\056\016\303\134\274\125\321\271\046"
	"\102\004\344\137\302\035\164\032\375\272\375\201\204\205\055\160"
	"\131\370\105\000\070\130\035\065\244\073\101\364\374\354\201\025"
	"\166\274\375\163\052\310\350\035\105\255\377\266\335\202\011\211"
	"\362\103\317\102\115\215\242\211\363\040\166\120\026\346\040\234"
	"\342\352\173\125\252\377\273\326\336\027\240\030\333\067\145\016"
	"\154\171\140\012\156\367\030\031\260\077\147\265\163\376\043\317"
	"\264\315\045\022\054\057\174\167\133\234\172\234\337\103\305\336"
	"\006\015\311\373\360\027\211\046\145\062\040\025\154\102\015\316"
	"\161\235\374\017\073\153\222\033\054\034\234\304\014\363\301\060"
	"\056\212\362\360\146\361\305\134\064\072\320\367\253\060\225\036"
	"\015\116\041\163\041\260\121\102\156\143\312\134\371\274\264\333"
	"\104\324\346\265\220\023\014\272\304\312\262\334\227\357\217\063"
	"\162\352\331\265\112\056\347\141\271\101\075\073\015\154\322\372"
	"\025\237\054\347\326\046\077\355\070\042\016\105\254\024\316\063"
	"\147\374\374\016\026\334\350\037\121\123\215\130\334\055\025\330"
	"\056\126\325\022\006\200\371\314\122\306\144\215\164\052\360\156"
	"\133\234\226\106\355\310\356\051\205\175\220\035\316\247\064\303"
	"\136\015\121\106\073\230\322\323\377\377\220\373\073\254\377\310"
	"\336\257\156\120\224\074\136\207\143\344\364\057\266\207\235\213"
	"\250\003\366\142\237\227\173\271\173\374\225\250\321\226\120\024"
	"\045\135\251\243\206\325\301\271\156\250\332\264\166\107\300\353"
	"\243\146\057\062\011\056\154\314\367\133\223\052\115\202\326\373"
	"\037\226\252\361\225\026\261\026\222\272\243\326\167\310\374\076"
	"\317\134\002\345\075\022\207\210\051\041\151\066\165\054\264\070"
	"\012\245\027\273\372\200\213\270\252\364\132\200\374\330\115\337"
	"\124\157\131\123\240\005\241\205\000\270\146\312\006\151\310\021"
	"\247\336\260\040\111\140\210\071\054\044\302\124\162\057\360\322"
	"\240\212\142\370\012\161\111\066\266\021\221\153\223\350\317\243"
	"\213\037\260\116\031\375\152\013\106\040\230\341\150\176\350\366"
	"\333\340\146\250\251\241\134\224\124\210\302\320\341\110\226\177"
	"\103\046\063\316\322\034\341\025\022\063\011\124\126\150\047\316"
	"\075\146\216\206\227\030\071\375\157\010\223\130\051\100\005\266"
	"\077\130\047\227\114\312\073\060\170\152\250\367\125\037\034\245"
	"\320\315\037\050\303\302\227\321\052\252\357\124\260\070\102\212"
	"\103\224\101\215\252\343\307\016\015\340\350\254\235\375\362\013"
	"\354\030\016\276\174\004\140\056\370\024\076\302\332\334\340\252"
	"\247\025\037\306\350\214\211\115\172\232\312\062\374\134\254\172"
	"\022\133\305\275\053\053\266\267\362\020\161\101\152\041\011\202"
	"\104\361\067\106\107\214\363\136\247\006\101\345\233\137\007\257"
	"\030\070\032\274\316\034\035\361\224\040\227\056\330\275\155\260"
	"\130\200\335\017\204\330\072\037\004\251\233\324\070\165\315\275"
	"\120\104\300\105\266\251\256\152\155\227\150\334\217\132\261\111"
	"\153\336\334\256\245\073\131\033\247\006\003\352\142\166\251\204"
	"\314\324\076\113\067\151\034\074\330\072\060\373\147\146\076\111"
	"\176\237\374\252\154\042\355\154\273\002\234\126\057\225\246\222"
	"\201\211\045\144\041\200\270\017\354\361\146\317\017\267\244\026"
	"\336\302\313\147\006\177\020\310\007\025\235\042\141\177\354\145"
	"\034\014\331\076\044\271\074\003\220\065\245\022\237\175\044\146"
	"\176\156\046\330\271\250\124\262\047\261\244\356\266\034\120\165"
	"\223\352\352\137\224\266\355\176\237\227\114\244\335\254\076\156"
	"\116\164\146\327\060\320\200\157\306\064\114\144\222\056\227\223"
	"\165\021\263\152\203\101\177\047\277\341\062\334\132\073\225\201"
	"\267\336\065\042\251\265\131\256\317\314\202\143\262\045\074\377"
	"\316\300\174\363\007\215\306\333\237\257\056\037\066\021\216\205"
	"\215\331\223\361\270\025\222\202\231\015\042\012\277\325\276\043"
	"\315\125\154\237\145\020\367\365\316\235\027\352\007\347\131\053"
	"\200\153\013\065\340\277\032\345\045\345\001\077\036\005\376\070"
	"\004\007\053\133\107\025\012\312\322\254\203\072\232\077\365\325"
	"\150\051\072\210\044\071\053\207\050\053\073\112\132\323\245\001"
	"\242\237\036\122\325\216\244\223\065\366\345\102\215\170\273\361"
	"\352\326\042\270\274\347\006\235\044\036\025\360\342\056\327\210"
	"\117\027\300\243\276\166\333\001\274\174\260\274\206\323\151\344"
	"\077\322\036\372\022\174\130\233\353\033\071\106\253\303\026\020"
	"\021\143\306\345\352\005\340\057\073\054\234\354\366\263\111\035"
	"\220\055\160\347\070\044\327\237\042\051\332\050\273\244\140\200"
	"\267\323\035\247\174\367\101\174\075\041\042\351\116\102\123\026"
	"\171\237\152\031\112\112\215\010\322\174\202\303\020\164\340\336"
	"\064\130\215\072\050\213\260\364\267\175\004\074\005\026\077\013"
	"\130\352\076\250\254\047\167\010\345\247\162\133\137\311\140\133"
	"\245\010\152\061\013\376\245\020\017\216\334\072\304\220\226\357"
	"\123\074\246\276\124\101\043\166\233\314\101\027\227\376\230\003"
	"\372\037\157\162\123\316\031\377\173\100\030\174\247\214\120\271"
	"\231\076\103\341\034\060\322\207\242\374\355\315\251\015\057\175"
	"\207\044\077\360\015\024\010\014\232\327\042\260\071\334\106\277"
	"\074\256\224\265\034\147\005\112\356\274\110\341\146\346\111\236"
	"\173\264\024\245\064\164\014\361\213\036\011\244\265\252\221\117"
	"\226\065\372\212\007\062\325\073\211\346\335\226\316\214\143\321"
	"\177\070\111\044\101\027\067\132\256\064\347\000\107\172\113\127"
	"\336\111\276\375\107\103\040\023\031\330\215\046\064\172\137\256"
	"\312\043\045\331\177\332\131\232\374\066\122\374\135\030\217\116"
	"\217\210\073\167\270\047\206\003\072\273\234\301\253\100\160\207"
	"\106\123\311\221\127\263\341\024\213\041\177\300\344\006\301\121"
	"\156\231\343\336\102\034\373\072\215\135\124\304\126\046\164\164"
	"\242\263\131\303\354\116\275\345\035\236\310\132\120\220\001\103"
	"\352\254\141\302\277\201\111\321\273\107\354\020\031\134\176\377"
	"\100\331\367\247\202\260\060\030\034\030\357\377\061\206\332\041"
	"\210\373\125\012\133\247\053\027\171\016\315\163\335\260\127\171"
	"\043\334\165\265\164\057\127\016\104\221\223\355\132\215\056\336"
	"\262\263\301\036\052\216\317\146\207\364\055\371\017\053\060\140"
	"\044\076\203\065\257\227\231\272\172\257\175\137\226\064\242\100"
	"\006\222\204\362\221\251\032\271\255\325\266\040\132\103\367\157"
	"\006\311\071\017\364\321\014\023\240\104\122\110\116\002\264\020"
	"\040\310\264\110\313\305\145\367\011\042\053\377\071\336\335\142"
	"\063\340\121\351\107\120\246\146\052\365\117\257\051\160\333\146"
	"\027\302\142\044\136\323\321\061\253\221\015\346\053\111\025\131"
	"\235\004\214\375\130\023\123\135\331\262\213\225\036\362\243\207"
	"\201\275\301\261\347\034\256\355\161\264\350\100\250\333\111\065"
	"\166\333\001\224\010\320\343\106\234\142\200\163\004\132\113\242"
	"\353\236\072\214\036\374\011\371\312\267\206\247\232\015\017\237"
	"\151\341\005\172\157\304\064\257\235\332\376\341\354\252\167\072"
	"\063\164\123\273\121\021\342\050\157\210\307\160\166\216\250\342"
	"\156\270\224\167\134\041\241\075\162\202\141\230\367\000\056\141"
	"\220\023\027\316\032\365\356\110\347\206\262\306\144\110\030\225"
	"\226\330\172\122\344\017\010\104\370\355\207\030\372\317\243\066"
	"\255\256\344\063\060\075\021\040\051\363\257\222\201\276\256\154"
	"\312\172\115\274\024\166\117\031\253\200\063\117\210\165\040\112"
	"\115\206\303\140\301\215\336\210\370\302\155\126\211\164\063\013"
	"\151\072\227\310\035\273\105\243\213\230\011\165\165\226\302\323"
	"\202\015\251\110\062\245\100\133\335\021\225\242\154\350\230\326"
	"\041\174\346\333\125\217\126\337\137\066\310\141\305\242\035\136"
	"\342\140\262\250\333\144\041\372\115\044\356\264\012\110\061\115"
	"\144\074\175\261\073\312\120\337\152\375\010\012\065\376\137\172"
	"\252\116\330\373\166\177\314\226\101\023\271\233\303\371\111\314"
	"\142\126\375\314\056\203\157\012\313\124\355\133\246\300\170\127"
	"\207\024\350\216\015\322\044\265\170\261\277\124\175\105\262\136"
	"\100\053\001\351\342\323\331\343\025\300\137\272\361\207\244\357"
	"\211\142\125\053\077\250\356\222\126\034\165\373\211\054\175\051"
	"\200\274\274\134\116\276\076\262\244\122\355\026\002\223\063\043"
	"\344\304\047\167\144\363\073\174\135\310\332\272\022\050\265\302"
	"\044\024\312\121\354\033\071\074\362\150\353\305\015\311\144\130"
	"\150\046\323\223\213\025\133\013\341\132\263\042\016\076\376\204"
	"\114\335\113\101\160\223\310\330\213\336\243\374\175\140\217\250"
	"\336\210\035\200\010\033\013\202\137\124\230\364\331\125\365\337"
	"\103\314\250\277\072\356\022\057\071\342\235\040\047\314\164\221"
	"\316\277\237\372\251\264\121\270\022\136\074\060\325\345\035\061"
	"\370\360\151\166\256\003\375\315\155\206\323\004\155\374\151\102"
	"\207\072\274\115\277\123\243\245\267\206\220\007\001\352\342\071"
	"\354\157\376\251\026\022\301\240\307\251\303\365\017\026\132\243"
	"\064\103\005\013\362\273\205\212\212\045\255\116\246\334\244\161"
	"\006\146\376\156\220\361\315\265\274\220\146\216\331\247\367\370"
	"\357\121\024\171\112\041\233\176\316\076\173\102\312\010\247\367"
	"\324\224\135\231\341\226\122\154\344\326\331\232\127\032\353\124"
	"\215\236\320\124\242\033\317\110\027\350\132\335\154\142\317\124"
	"\305\136\303\051\360\171\275\221\344\170\071\117\336\304\013\234"
	"\277\005\120\167\162\200\147\313\146\330\231\215\372\113\147\347"
	"\251\003\217\036\315\247\073\024\233\022\200\132\321\263\056\240"
	"\276\173\060\332\162\125\152\201\212\120\070\355\007\203\171\316"
	"\121\243\040\003\154\224\320\272\132\275\351\353\065\271\311\054"
	"\267\014\074\171\066\070\151\375\121\241\377\344\262\321\113\177"
	"\320\326\133\020\103\172\171\120\204\012\110\341\177\165\134\023"
	"\110\355\066\365\133\143\215\335\300\114\017\322\340\117\323\234"
	"\257\107\035\141\347\145\021\210\140\332\365\164\052\306\234\047"
	"\105\006\020\036\211\104\000\047\234\273\106\054\236\001\357\142"
	"\202\255\023\275\035\021\016\061\065\276\265\212\047\142\171\034"
	"\230\137\317\275\331\006\332\365\221\172\364\330\013\110\270\037"
	"\225\202\342\244\336\362\014\133\006\072\054\160\133\364\271\003"
	"\325\213\056\257\341\037\146\156\356\042\163\136\205\062\075\042"
	"\266\312\123\373\217\224\170\103\250\213\376\144\326\037\077\161"
	"\160\103\026\014\267\163\323\174\343\123\012\276\052\231\173\073"
	"\076\336\351\032\076\136\372\045\172\037\222\175\127\026\141\114"
	"\016\311\062\140\047\021\234\333\042\222\064\032\251\271\064\223"
	"\336\037\040\126\075\203\017\173\064\322\220\231\007\103\204\225"
	"\040\303\025\101\126\135\050\353\034\103\155\166\336\335\353\113"
	"\365\066\066\147\242\152\174\224\270\155\374\205\262\027\227\312"
	"\316\261\003\075\347\042\042\236\030\344\050\060\011\111\347\224"
	"\234\233\075\375\030\000\065\231\344\231\200\300\325\170\376\075"
	"\232\160\263\253\136\163\037\253\214\366\027\066\246\243\031\234"
	"\011\240\174\340\322\375\376\251\343\023\042\223\267\265\121\265"
	"\227\111\007\017\054\260\103\340\063\064\151\314\307\265\271\252"
	"\266\003\137\134\335\211\310\217\125\346\375\307\327\143\241\310"
	"\355\013\074\023\003\336\274\114\240\337\005\130\070\267\150\042"
	"\325\336\205\065\162\277\050\376\221\242\012\030\004\362\324\202"
	"\066\354\253\144\333\374\361\156\065\367\143\024\031\234\150\044"
	"\315\355\235\173\131\003\025\110\312\075\042\201\116\035\344\172"
	"\262\042\343\200\126\215\203\314\362\356\077\330\331\010\113\071"
	"\316\351\231\116\312\023\114\024\014\075\257\106\271\143\324\060"
	"\225\356\107\052\343\225\025\005\151\231\340\013\251\225\047\023"
	"\025\362\065\363\351\161\223\320\302\047\307\376\360\106\325\236"
	"\337\006\105\234\176\074\022\000\362\253\246\330\164\140\101\267"
	"\150\062\055\061\354\322\370\263\355\160\304\025\351\004\270\040"
	"\241\361\334\107\354\216\325\013\241\140\356\001\207\131\016\360"
	"\163\174\043\011\152\012\060\252\042\054\303\222\362\277\271\106"
	"\056\263\026\357\206\257\025\301\304\345\276\015\231\162\272\312"
	"\250\075\271\067\337\173\162\232\135\352\004\265\077\142\353\022"
	"\217\301\056\076\061\127\015\112\151\036\214\221\210\151\024\333"
	"\150\205\164\240\377\260\155\377\154\141\100\211\237\327\107\261"
	"\074\076\241\055\355\007\276\023\071\173\330\234\010\152\361\274"
	"\167\254\363\002\317\267\252\337\033\114\031\354\215\141\224\013"
	"\076\272\172\004\275\323\156\151\205\022\213\217\216\006\367\035"
	"\110\335\024\136\271\257\103\264\113\326\100\113\302\056\321\065"
	"\245\221\253\007\254\116\150\242\136\305\225\305\077\040\127\145"
	"\157\177\264\166\225\105\027\056\040\361\074\057\103\161\176\001"
	"\301\357\061\370\246\231\200\240\023\353\223\112\134\240\066\136"
	"\131\262\155\260\213\107\200\065\110\202\246\043\115\210\245\244"
	"\257\235\355\200\007\076\233\033\101\273\015\372\137\017\202\102"
	"\270\040\040\027\146\051\373\206\210\036\251\161\222\207\357\132"
	"\102\021\012\161\354\031\316\131\172\210\207\131\111\205\255\314"
	"\177\366\322\201\271\245\205\115\332\132\074\260\153\211\235\046"
	"\047\042\301\044\063\336\231\073\210\163\270\144\071\142\061\166"
	"\063\154\020\237\104\140\276\157\104\133\125\046\331\125\367\073"
	"\077\005\361\113\251\020\034\004\031\067\055\177\255\313\315\163"
	"\021\371\017\357\220\044\347\360\040\337\065\141\367\105\120\176"
	"\047\173\205\356\275\336\047\212\333\142\207\113\231\124\171\200"
	"\374\257\026\032\304\330\123\256\261\152\325\172\177\200\057\020"
	"\201\110\154\041\254\326\260\201\200\205\050\210\256\341\201\267"
	"\100\326\073\356\024\013\131\354\363\346\371\200\271\114\016\236"
	"\030\072\105\254\321\301\376\272\121\375\257\136\204\323\142\110"
	"\332\256\071\162\303\030\115\154\231\147\016\356\072\373\215\371"
	"\333\243\212\164\111\126\025\330\174\205\175\376\266\207\324\322"
	"\326\010\076\334\262\274\207\010\065\025\070\205\056\114\272\343"
	"\146\305\222\041\374\377\121\376\213\254\071\055\161\142\236\154"
	"\264\060\113\105\065\340\010\264\331\354\070\220\317\252\334\361"
	"\370\256\031\041\302\155\245\160\314\121\143\361\244\303\242\272"
	"\137\121\371\110\022\113\105\260\247\172\051\172\116\201\046\334"
	"\117\215\320\144\157\036\354\272\345\122\035\012\353\225\133\127"
	"\213\151\074\052\261\045\100\127\077\013\221\223\242\302\005\305"
	"\231\154\114\033\050\113\101\015\215\110\056\150\274\240\317\101"
	"\272\113\073\157\333\337\143\266\275\043\272\232\305\200\236\333"
	"\106\370\113\212\312\363\061\133\230\064\162\143\006\022\131\266"
	"\336\011\317\344\320\320\320\104\032\026\212\076\105\060\075\054"
	"\231\252\153\351\301\373\327\073\235\044\377\254\236\065\030\072"
	"\132\262\044\300\206\244\216\273\227\333\222\071\067\361\262\307"
	"\155\026\121\263\253\177\021\161\057\201\354\310\165\273\104\017"
	"\234\065\135\110\103\353\003\333\306\226\025\376\207\310\305\364"
	"\336\026\250\212\225\271\374\305\072\350\216\260\244\323\277\100"
	"\010\034\210\114\010\214\050\317\042\076\315\252\006\222\237\345"
	"\251\107\160\077\001\154\005\073\125\224\354\371\147\253\071\157"
	"\307\302\274\320\116\345\237\160\043\154\032\052\377\272\017\251"
	"\001\200\350\002\354\356\076\101\202\052\073\351\326\164\131\236"
	"\067\025\156\205\373\015\366\037\172\020\111\172\312\131\043\314"
	"\331\013\317\306\371\015\007\173\070\103\145\016\267\276\254\357"
	"\323\033\164\317\051\152\356\243\173\070\035\106\221\101\022\153"
	"\115\341\061\107\357\071\303\047\174\050\066\064\346\342\043\272"
	"\376\227\211\047\002\167\313\175\257\351\304\101\052\327\254\167"
	"\270\336\276\250\027\201\317\223\251\006\310\217\351\353\112\347"
	"\203\323\016\206\113\332\003\373\303\310\074\355\237\351\145\130"
	"\310\044\000\337\245\320\163\117\326\073\337\277\047\051\246\253"
	"\375\265\061\110\217\065\103\122\375\200\100\234\152\245\364\062"
	"\312\365\022\160\305\206\277\234\302\237\133\351\311\002\224\306"
	"\267\306\017\107\373\123\231\370\323\332\225\076\200\212\160\112"
	"\177\203\272\105\011\172\341\313\032\074\265\343\077\112\252\366"
	"\020\272\075\013\015\327\004\341\262\231\037\062\044\220\174\243"
	"\024\067\350\035\261\311\351\313\006\237\257\105\351\132\074\372"
	"\024\172\006\041\122\013\003\004\244\042\066\310\263\263\154\307"
	"\352\125\345\234\036\316\150\045\155\027\153\127\162\247\122\206"
	"\041\130\250\164\143\253\170\010\316\257\321\202\142\075\111\115"
	"\222\056\351\261\375\122\327\153\152\102\303\334\351\025\142\013"
	"\155\013\177\321\267\370\331\205\247\253\007\011\351\121\127\174"
	"\200\101\055\175\223\005\351\375\107\255\331\061\302\074\075\060"
	"\110\275\002\377\265\333\204\134\207\214\146\160\336\276\354\136"
	"\377\032\334\222\037\305\217\147\162\151\230\065\245\326\145\355"
	"\223\147\355\110\103\162\245\313\376\014\073\334\312\050\073\311"
	"\103\027\134\142\335\353\312\120\125\142\206\373\070\354\350\314"
	"\123\326\024\227\110\272\143\106\307\237\043\221\307\136\133\013"
	"\166\267\156\124\243\070\244\370\233\052\363\324\026\334\240\152"
	"\262\265\002\372\157\145\101\067\005\145\310\314\304\043\327\072"
	"\333\105\217\176\176\063\167\031\136\153\355\165\107\215\340\372"
	"\103\343\365\263\110\067\352\116\234\262\032\140\326\362\233\262"
	"\070\052\061\266\136\250\320\275\024\275\063\134\113\023\126\216"
	"\366\114\101\077\203\054\215\037\336\250\200\265\232\034\150\323"
	"\107\231\212\245\102\132\143\126\030\226\262\143\251\010\362\240"
	"\124\064\337\330\140\154\367\077\025\170\365\260\224\135\203\333"
	"\366\016\201\070\150\345\216\200\173\100\344\045\111\326\305\236"
	"\012\244\166\153\021\156\252\046\347\237\326\173\374\132\127\363"
	"\150\331\054\321\276\272\121\071\373\066\136\105\014\043\344\027"
	"\310\132\202\331\311\054\000\260\314\327\054\311\061\204\274\232"
	"\135\350\153\033\243\275\124\237\363\263\344\000\327\310\027\237"
	"\043\231\171\355\306\172\236\223\121\312\134\203\116\031\035\254"
	"\002\211\307\245\106\034\104\071\317\051\071\247\362\121\106\025"
	"\353\300\003\262\072\241\105\213\154\242\017\273\273\054\147\275"
	"\266\057\142\374\113\247\066\033\320\160\302\303\302\010\330\255"
	"\311\334\137\003\175\244\217\352\106\236\245\002\313\015\277\201"
	"\074\042\176\207\311\264\242\232\045\145\135\347\156\066\224\067"
	"\022\364\072\220\230\312\172\337\151\040\341\064\055\241\266\152"
	"\303\064\361\215\351\224\050\016\372\205\366\150\274\213\237\317"
	"\177\332\140\030\244\332\370\015\373\331\102\051\172\370\223\076"
	"\054\205\313\026\032\363\045\024\171\033\174\066\247\034\005\047"
	"\366\145\077\233\100\067\251\074\021\353"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
