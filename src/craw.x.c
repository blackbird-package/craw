#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/devel/project/blackbird/apps/craw/src/craw -o /home/devel/project/blackbird/apps/craw/pkg/craw 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\043"
#define      pswd_z	256
#define      pswd	((&data[57]))
	"\362\063\326\145\100\215\167\236\066\006\077\077\345\214\066\204"
	"\060\121\027\367\366\125\140\021\332\315\235\330\315\174\221\277"
	"\257\147\044\360\365\233\216\054\242\315\154\207\132\243\013\212"
	"\365\043\202\353\170\343\375\122\315\120\145\367\037\061\040\301"
	"\363\130\301\045\036\064\157\052\160\050\040\133\222\320\372\213"
	"\177\071\052\013\136\260\303\054\000\051\043\037\132\104\341\115"
	"\234\243\163\272\330\342\345\110\013\005\243\235\326\235\051\125"
	"\327\123\141\066\003\044\142\004\115\206\044\247\312\005\365\146"
	"\250\150\040\200\113\005\311\126\013\155\364\341\013\035\067\343"
	"\161\230\031\164\274\173\171\012\001\235\262\314\242\247\062\113"
	"\020\123\314\133\131\225\262\144\003\246\106\016\304\175\361\065"
	"\025\013\252\322\207\043\334\211\300\216\125\143\066\207\256\106"
	"\333\173\242\064\021\124\231\024\373\337\043\277\134\024\364\162"
	"\040\237\104\247\302\041\060\202\257\205\346\346\015\224\054\351"
	"\020\316\036\041\043\267\065\036\227\130\335\364\155\322\146\216"
	"\161\253\065\063\315\146\266\175\354\234\143\371\061\217\343\101"
	"\136\001\143\201\270\231\237\120\361\174\104\137\117\253\356\300"
	"\126\043\364\043\212\252\240\166\107\004\160\170\223\123\272\361"
	"\124\036\162\015\267\022\135\251\217\241\010\336\114\366\237\243"
	"\032\223\307\244\075\150\033\205\260\232\053\175\026\274\075\306"
	"\044\141\266\032\375\104\107\237\022\263\047\155\127\063\367\114"
	"\126\172\067\317\136\065\042\016\320\115\214\347\012\311\255\056"
	"\052\144\111\047\250\220"
#define      opts_z	1
#define      opts	((&data[359]))
	"\173"
#define      tst2_z	19
#define      tst2	((&data[360]))
	"\354\224\111\116\174\102\202\162\041\223\141\301\077\036\313\215"
	"\302\163\027\042\040\347"
#define      tst1_z	22
#define      tst1	((&data[385]))
	"\110\371\124\172\374\130\340\304\164\002\245\307\175\204\116\337"
	"\055\354\345\076\054\020\164\121\066"
#define      chk1_z	22
#define      chk1	((&data[407]))
	"\251\352\023\202\026\033\024\303\100\316\130\014\171\277\162\054"
	"\370\145\304\110\316\155"
#define      rlax_z	1
#define      rlax	((&data[429]))
	"\262"
#define      text_z	3784
#define      text	((&data[773]))
	"\361\207\036\072\256\307\312\166\202\016\144\253\252\207\313\221"
	"\000\146\260\110\137\005\263\147\053\153\373\067\056\130\362\040"
	"\337\021\132\216\330\045\004\133\064\151\006\336\360\322\157\360"
	"\070\040\070\230\046\354\000\121\127\373\211\206\123\174\246\062"
	"\215\001\301\145\046\305\301\132\056\310\070\036\232\250\016\323"
	"\310\107\154\357\063\154\101\213\150\312\022\273\107\270\356\324"
	"\271\257\072\337\165\373\072\243\303\162\302\136\033\321\061\344"
	"\030\235\323\114\011\024\330\162\337\352\056\047\243\034\373\134"
	"\314\065\074\102\061\167\345\365\352\250\123\005\171\205\351\222"
	"\042\275\336\054\322\267\236\262\242\314\331\105\351\324\242\266"
	"\012\337\370\074\126\336\061\100\206\205\106\000\013\060\222\055"
	"\355\161\132\277\050\371\161\312\306\112\020\260\037\262\147\051"
	"\221\137\145\350\076\227\051\305\035\157\305\050\237\127\126\215"
	"\310\261\114\361\253\276\274\161\010\314\041\047\176\210\121\020"
	"\350\267\370\047\117\041\354\154\221\261\225\061\011\354\276\322"
	"\236\013\304\111\311\200\272\322\114\334\372\313\144\113\333\115"
	"\003\324\164\122\365\141\277\207\023\124\270\034\101\167\357\337"
	"\202\263\051\114\063\343\037\200\300\031\113\045\145\047\162\150"
	"\373\347\273\361\110\172\170\133\317\061\170\020\251\147\360\054"
	"\032\031\170\115\375\227\316\275\261\031\342\027\100\124\200\074"
	"\074\073\055\204\265\246\337\205\327\130\225\200\277\206\254\331"
	"\237\045\047\235\275\366\132\022\107\042\147\061\021\235\054\116"
	"\233\373\217\120\325\164\317\323\200\003\246\157\216\364\101\132"
	"\061\331\326\226\257\026\335\375\077\010\105\127\076\015\165\033"
	"\130\240\252\277\342\037\154\306\144\111\140\044\273\174\345\216"
	"\337\075\103\135\345\367\262\261\301\012\264\175\377\010\203\007"
	"\057\253\032\325\356\265\054\017\032\334\110\370\245\054\252\162"
	"\023\305\042\023\145\366\055\104\332\361\014\113\316\163\000\064"
	"\251\326\156\223\371\002\330\102\132\254\177\332\231\162\134\123"
	"\140\026\264\162\023\170\166\240\273\340\350\222\174\306\043\252"
	"\360\151\274\362\165\261\045\000\265\311\015\246\051\336\202\040"
	"\034\016\361\112\344\040\314\366\152\101\045\366\010\031\217\140"
	"\103\223\114\201\361\275\307\214\342\325\333\033\204\155\132\060"
	"\172\142\067\162\152\007\065\015\333\272\210\277\254\101\174\376"
	"\225\301\205\302\036\271\053\320\152\022\266\326\270\011\210\125"
	"\272\336\034\154\201\250\025\267\257\361\204\113\360\063\242\241"
	"\314\122\227\023\324\377\374\001\172\362\164\172\013\300\027\153"
	"\071\016\136\261\135\305\167\054\074\273\103\211\365\213\133\012"
	"\172\222\135\125\206\070\233\113\312\255\205\332\352\034\332\140"
	"\222\366\065\124\005\377\000\157\264\301\007\373\261\025\127\221"
	"\051\204\204\156\040\144\113\255\027\102\145\313\063\131\327\301"
	"\077\303\231\321\235\300\010\365\226\257\266\134\366\016\104\116"
	"\227\123\227\227\307\142\054\232\322\364\153\003\065\343\250\173"
	"\106\071\262\106\133\101\015\234\265\340\044\277\115\363\304\014"
	"\330\035\124\345\275\136\150\365\002\062\161\313\120\063\151\175"
	"\055\067\177\225\317\374\204\245\027\044\116\021\321\350\367\164"
	"\124\264\176\260\004\153\073\160\343\352\100\066\235\015\162\275"
	"\266\373\311\044\133\216\044\163\253\304\076\375\332\210\331\000"
	"\007\344\076\351\066\265\014\155\046\030\341\057\072\311\073\327"
	"\061\034\200\224\035\152\107\376\322\233\163\316\241\147\211\072"
	"\321\001\242\102\060\053\064\146\131\217\023\050\204\127\023\363"
	"\254\042\055\342\240\254\034\121\076\072\300\375\060\220\120\217"
	"\235\062\117\057\047\241\206\314\132\156\042\377\065\252\102\276"
	"\040\166\222\060\176\263\177\026\245\016\052\050\276\161\076\000"
	"\073\344\265\204\063\200\206\113\231\135\155\223\224\127\132\251"
	"\311\374\363\337\050\065\106\100\245\076\216\255\075\142\356\133"
	"\133\107\114\061\031\344\313\266\120\074\102\363\220\007\107\120"
	"\274\327\271\253\371\021\334\172\261\350\074\043\104\174\115\215"
	"\076\356\142\323\020\300\307\014\037\100\215\063\222\247\050\335"
	"\240\205\217\035\213\257\324\345\076\303\167\221\262\074\106\117"
	"\343\211\312\216\135\336\231\005\311\210\330\376\370\214\332\201"
	"\205\164\236\162\143\034\357\011\067\100\205\206\273\146\307\326"
	"\206\006\077\003\363\305\143\022\241\156\347\337\045\111\024\001"
	"\044\160\223\114\154\251\241\062\200\366\242\005\342\315\115\322"
	"\046\163\143\231\025\375\225\000\344\214\070\021\272\254\300\054"
	"\202\342\253\165\214\172\132\271\337\256\110\012\222\155\204\332"
	"\133\352\254\001\310\043\161\037\233\026\371\374\120\066\013\320"
	"\324\161\146\177\221\365\000\030\226\057\075\166\032\237\054\250"
	"\377\066\124\316\245\335\054\120\104\031\327\137\133\020\203\053"
	"\277\356\104\117\373\316\236\241\020\061\010\367\206\060\107\042"
	"\176\305\371\226\372\346\146\051\131\140\276\234\337\232\021\046"
	"\056\026\357\157\201\306\140\023\221\372\230\300\044\221\323\175"
	"\230\363\131\206\162\207\064\036\255\360\044\204\315\321\135\125"
	"\025\156\140\074\147\306\010\031\043\221\011\011\321\020\353\207"
	"\056\231\136\374\023\222\213\176\135\242\060\310\343\313\214\300"
	"\344\177\135\024\155\361\076\352\112\227\336\142\342\043\143\126"
	"\172\353\055\064\056\317\207\107\070\143\153\014\325\324\376\133"
	"\136\254\112\375\124\052\060\001\331\136\325\343\150\310\113\160"
	"\065\005\352\213\250\073\357\350\022\256\352\225\245\015\225\274"
	"\153\066\026\177\126\274\127\173\360\233\025\256\205\210\137\271"
	"\004\140\007\226\174\004\372\350\005\064\305\237\025\171\037\015"
	"\125\043\133\250\053\001\056\265\011\202\201\006\177\100\344\246"
	"\067\152\110\141\160\106\246\205\323\210\346\154\017\363\074\226"
	"\054\103\105\122\106\151\266\324\357\262\142\253\244\207\216\341"
	"\027\036\301\074\225\057\263\003\014\370\326\342\355\003\342\152"
	"\174\336\110\014\016\311\314\076\002\304\251\152\203\345\124\265"
	"\261\217\102\237\035\334\340\055\331\257\111\372\154\020\057\211"
	"\041\312\303\076\115\051\052\366\126\070\262\357\146\206\114\007"
	"\132\244\242\037\176\217\306\232\372\233\160\234\320\275\134\272"
	"\077\154\167\165\141\070\003\054\243\106\036\152\212\004\031\104"
	"\167\132\247\362\260\111\130\241\215\125\002\045\054\015\260\061"
	"\256\144\267\364\274\056\250\201\377\332\206\233\372\114\174\036"
	"\137\051\317\127\054\075\256\132\155\276\357\171\261\160\266\351"
	"\276\341\214\240\313\221\365\355\367\124\114\132\151\307\262\243"
	"\341\245\010\337\146\151\016\164\055\266\123\333\143\042\173\044"
	"\032\102\236\147\046\134\145\333\035\334\003\170\241\203\372\225"
	"\206\054\177\017\002\224\273\203\242\103\341\170\234\012\346\177"
	"\317\254\135\125\357\254\062\123\132\101\203\164\017\020\276\244"
	"\045\207\367\012\313\216\135\131\354\266\247\124\067\376\357\315"
	"\130\222\036\022\337\172\024\350\003\240\163\230\233\025\276\032"
	"\070\210\320\004\036\336\253\110\304\256\254\313\360\226\221\034"
	"\275\335\374\170\120\344\351\037\257\011\021\050\235\000\253\302"
	"\273\214\034\236\232\206\300\275\326\045\050\240\214\271\050\237"
	"\043\006\337\317\332\130\320\122\120\046\265\210\044\057\161\367"
	"\162\346\054\337\250\060\326\003\267\230\210\023\321\047\235\061"
	"\051\332\067\134\021\135\204\151\172\043\265\244\100\022\060\142"
	"\207\302\347\235\333\042\113\301\376\114\046\214\200\122\203\326"
	"\362\057\127\320\054\013\050\314\307\227\027\064\104\307\352\031"
	"\312\073\301\255\067\171\371\012\173\341\022\321\020\133\147\137"
	"\057\107\331\270\233\157\275\234\202\054\205\363\136\046\211\142"
	"\102\377\153\006\116\023\116\222\111\232\240\106\210\341\176\167"
	"\354\153\170\352\313\170\070\324\073\331\240\155\301\270\247\300"
	"\235\314\005\013\231\214\106\002\156\237\166\074\145\075\271\276"
	"\227\034\332\111\371\040\121\123\165\371\203\041\242\212\154\140"
	"\117\362\257\222\347\053\036\003\213\031\161\265\134\331\166\030"
	"\211\105\017\331\033\320\306\136\350\273\332\311\107\220\055\341"
	"\055\357\143\335\371\337\272\361\314\126\272\042\165\060\141\045"
	"\134\331\104\160\320\177\117\203\344\332\153\117\175\121\214\272"
	"\147\336\337\252\243\345\153\227\202\262\157\100\270\265\376\033"
	"\374\310\353\374\042\254\127\232\375\356\374\204\055\331\020\137"
	"\360\214\240\120\350\251\356\064\126\323\117\271\351\315\111\345"
	"\375\212\274\101\256\302\172\323\355\070\266\336\337\237\270\322"
	"\271\232\127\241\363\152\054\263\165\241\315\155\116\302\025\040"
	"\344\035\025\072\154\203\060\103\272\300\232\075\075\224\202\063"
	"\057\267\230\273\341\347\064\370\275\066\037\242\115\122\312\202"
	"\201\002\347\102\202\310\150\370\133\051\214\136\131\253\313\214"
	"\214\106\004\027\231\322\207\335\334\242\201\333\015\232\044\110"
	"\150\071\031\036\145\040\010\111\250\141\322\220\206\076\313\303"
	"\232\362\035\007\147\323\320\100\250\344\372\164\230\023\151\156"
	"\066\261\137\224\072\221\207\143\376\062\012\067\012\106\164\033"
	"\264\123\374\273\167\216\003\156\001\034\257\125\132\256\074\172"
	"\242\013\170\212\010\067\217\355\152\116\020\040\100\113\153\132"
	"\207\264\371\131\203\252\231\164\125\215\253\355\007\102\225\051"
	"\072\036\243\307\322\364\353\263\354\132\301\322\000\257\166\134"
	"\341\130\142\354\276\045\330\024\341\162\317\061\021\036\156\302"
	"\105\066\322\342\032\277\263\327\236\254\176\346\257\025\347\213"
	"\005\052\336\330\263\106\027\271\306\221\346\267\270\136\022\011"
	"\060\023\222\372\255\055\367\143\154\101\104\306\246\027\203\065"
	"\145\350\367\240\023\373\031\235\274\242\010\344\116\071\211\302"
	"\040\217\261\322\235\124\157\264\016\102\204\053\236\043\306\131"
	"\343\313\023\137\165\115\135\155\251\214\136\035\045\266\070\064"
	"\041\011\345\051\307\342\367\133\307\353\165\322\113\254\246\056"
	"\221\131\265\104\234\203\226\110\346\155\316\174\123\256\007\312"
	"\242\023\226\020\137\303\274\075\250\121\011\017\142\116\166\052"
	"\035\161\302\375\064\001\056\234\205\331\146\204\246\371\062\015"
	"\076\170\100\376\202\047\040\033\141\272\052\103\143\003\047\023"
	"\372\167\071\075\124\167\047\374\064\344\275\207\157\023\113\015"
	"\312\361\270\052\305\034\376\240\016\322\133\152\343\030\323\054"
	"\361\320\026\115\043\330\124\137\257\163\370\262\256\067\252\272"
	"\306\167\361\030\011\204\257\326\173\306\261\363\356\035\241\267"
	"\176\242\365\130\206\063\327\072\216\045\047\127\032\364\131\374"
	"\117\035\231\255\360\263\120\273\126\302\075\130\240\050\373\222"
	"\013\235\010\022\133\343\164\237\113\074\264\035\157\207\113\204"
	"\161\154\015\163\237\323\347\166\205\172\271\143\052\236\257\351"
	"\146\160\000\276\237\314\055\274\314\365\077\337\217\312\362\034"
	"\131\101\371\372\246\243\116\033\365\314\361\070\120\040\042\341"
	"\374\001\303\306\365\044\040\207\366\107\253\060\272\311\347\306"
	"\343\344\344\010\304\272\006\261\247\074\371\041\165\134\152\115"
	"\371\312\027\237\247\120\325\125\255\124\330\263\303\066\355\370"
	"\233\324\125\173\276\027\070\352\336\314\245\166\015\035\137\245"
	"\374\142\137\154\135\045\346\043\220\353\266\222\177\374\261\225"
	"\031\077\042\023\042\053\345\065\377\342\313\311\246\212\277\125"
	"\244\137\260\106\377\262\240\067\273\312\164\156\225\173\153\056"
	"\214\376\074\120\256\262\254\347\224\100\130\335\347\123\026\163"
	"\330\335\160\212\322\364\211\103\224\367\217\107\211\320\265\273"
	"\131\105\236\222\235\143\030\026\343\036\374\273\070\015\204\247"
	"\115\142\372\007\257\156\263\026\255\236\034\175\317\073\331\107"
	"\376\055\142\224\326\201\115\066\314\360\276\031\371\055\030\040"
	"\063\250\075\162\152\064\252\070\062\112\237\025\101\050\044\215"
	"\106\106\034\131\227\007\237\105\144\121\070\122\131\037\016\170"
	"\135\233\276\304\027\103\211\151\277\313\366\064\045\215\237\351"
	"\023\325\134\201\226\320\053\242\040\326\235\317\040\272\127\075"
	"\247\276\270\121\231\320\164\211\215\160\044\063\353\004\017\173"
	"\017\040\156\325\072\221\110\126\302\310\310\330\257\144\255\355"
	"\112\000\242\125\330\305\226\030\266\001\076\201\377\213\102\344"
	"\130\142\115\176\203\100\050\105\303\207\334\341\060\210\104\172"
	"\254\346\301\206\030\173\200\066\346\212\333\010\045\253\175\000"
	"\127\366\321\036\333\005\253\046\040\056\234\366\306\231\261\222"
	"\011\214\132\217\264\243\125\264\045\107\177\264\173\075\355\246"
	"\057\237\071\335\144\205\027\232\331\072\176\213\235\210\305\236"
	"\223\234\154\204\131\062\306\217\073\371\311\334\147\045\363\322"
	"\270\212\120\260\267\337\112\203\146\110\142\216\323\123\267\217"
	"\111\265\363\143\225\216\001\354\325\370\211\340\344\366\207\165"
	"\200\117\361\002\354\176\227\065\164\237\266\166\001\257\266\143"
	"\153\177\126\351\356\131\321\255\206\346\067\173\320\175\356\205"
	"\107\300\041\257\363\130\140\243\041\037\076\346\062\033\003\057"
	"\102\275\250\007\233\022\247\074\007\257\124\353\274\046\277\322"
	"\356\064\373\306\307\355\213\167\210\036\023\201\155\153\136\164"
	"\215\216\117\307\301\316\315\307\072\020\022\236\041\360\114\266"
	"\026\363\341\360\312\052\037\174\043\321\217\253\215\107\017\273"
	"\255\072\050\046\016\004\133\072\064\312\120\323\031\051\024\227"
	"\135\163\213\241\067\154\050\231\024\071\172\255\320\347\102\373"
	"\146\220\064\117\327\204\231\301\006\303\340\244\146\007\341\340"
	"\046\242\354\132\112\330\121\056\353\261\326\354\004\170\314\301"
	"\321\002\033\014\346\370\156\314\071\110\302\355\057\043\045\324"
	"\220\037\003\327\144\035\174\343\030\134\177\125\365\256\026\165"
	"\127\123\245\341\254\166\374\321\116\373\250\311\321\061\034\332"
	"\246\063\135\134\350\174\326\371\315\170\240\247\165\131\205\141"
	"\271\061\037\013\257\216\047\253\111\062\275\202\252\375\034\254"
	"\243\073\330\147\120\165\347\077\115\122\272\254\374\354\117\303"
	"\312\071\045\222\165\270\251\312\012\233\202\166\350\112\350\153"
	"\161\022\225\007\074\266\354\014\240\000\300\177\313\143\251\220"
	"\171\127\222\357\101\061\103\066\136\210\261\221\344\332\023\154"
	"\065\016\150\305\112\251\232\354\372\232\303\150\017\070\254\237"
	"\354\361\022\061\055\277\356\375\063\124\077\115\142\124\265\007"
	"\017\356\220\323\020\271\352\363\007\367\034\051\204\215\037\364"
	"\127\345\156\240\315\010\160\211\221\066\302\026\325\243\315\240"
	"\025\111\343\277\352\131\372\264\017\221\341\136\310\012\016\352"
	"\323\004\364\212\054\037\271\212\266\101\167\027\040\325\253\202"
	"\360\146\303\125\364\032\150\157\006\370\067\351\114\120\121\156"
	"\025\117\306\233\123\105\011\072\106\074\167\336\274\004\272\102"
	"\253\152\324\055\033\101\372\305\120\156\102\321\224\101\331\053"
	"\376\237\120\126\003\027\065\315\200\225\026\063\361\354\022\204"
	"\240\261\374\002\126\246\332\157\335\357\264\335\074\164\243\355"
	"\334\374\261\332\032\024\143\270\141\243\163\357\127\235\031\026"
	"\105\057\104\307\156\117\011\132\074\116\303\304\157\057\104\377"
	"\170\260\167\312\274\361\324\234\043\346\002\140\001\270\101\211"
	"\010\251\136\355\002\127\312\221\127\210\111\057\156\064\302\156"
	"\027\236\052\332\037\145\136\002\333\310\101\126\306\251\146\042"
	"\204\324\211\044\143\162\071\233\331\104\130\342\141\116\372\372"
	"\120\325\314\310\065\354\100\315\216\012\145\231\254\347\270\164"
	"\262\320\250\264\101\176\047\353\327\262\223\221\114\131\126\026"
	"\317\357\274\204\253\300\104\264\270\163\243\002\355\072\057\141"
	"\331\061\052\330\310\147\017\006\321\124\375\343\323\357\371\210"
	"\221\307\275\353\325\317\122\365\120\116\152\021\037\106\030\227"
	"\077\147\064\040\301\240\004\144\104\310\054\011\305\321\126\216"
	"\037\350\236\166\161\045\244\171\130\351\167\107\023\062\317\223"
	"\151\317\372\052\113\045\305\165\132\144\237\210\371\304\151\030"
	"\151\061\142\164\204\145\174\123\063\176\113\265\313\352\333\113"
	"\222\143\126\324\235\151\375\356\125\005\250\323\271\265\170\211"
	"\020\027\173\351\054\316\142\372\067\041\011\360\324\056\202\135"
	"\121\372\155\047\132\150\167\277\105\023\207\332\200\174\046\137"
	"\013\125\105\374\342\041\362\274\233\036\001\246\050\213\113\040"
	"\364\321\333\222\175\351\313\374\264\310\070\253\155\255\061\106"
	"\241\150\141\334\343\274\103\310\227\276\011\165\113\043\125\251"
	"\047\373\240\200\046\155\220\150\166\100\170\261\316\231\022\002"
	"\310\360\116\217\016\221\366\265\060\105\353\331\116\231\242\133"
	"\037\342\254\143\314\277\202\341\077\043\370\056\132\127\123\370"
	"\206\026\076\242\355\303\072\110\163\004\154\045\010\214\317\155"
	"\062\265\053\255\117\057\376\006\050\054\307\255\274\244\046\252"
	"\102\201\060\007\012\175\174\302\244\235\263\062\306\146\310\354"
	"\062\237\170\262\034\015\206\113\117\377\104\371\223\170\345\041"
	"\075\072\370\306\007\065\226\060\333\276\350\045\171\255\311\016"
	"\160\342\110\242\304\111\347\152\320\030\263\146\234\053\301\203"
	"\127\044\121\056\105\164\236\033\146\355\374\375\112\174\142\042"
	"\001\060\026\213\261\217\324\107\313\327\263\363\176\277\133\057"
	"\043\117\021\231\045\174\263\107\353\026\224\251\126\154\001\347"
	"\213\036\361\372\165\304\303\327\021\165\133\045\155\306\310\302"
	"\255\310\250\253\265\117\143\007\154\213\002\377\006\031\365\032"
	"\063\162\154\265\377\334\025\277\040\076\316\232\266\315\033\211"
	"\031\327\357\223\323\342\200\172\030\053\261\040\151\132\017\327"
	"\312\202\064\046\051\100\367\123\154\152\306\214\340\056\042\054"
	"\111\056\172\234\031\370\110\056\214\063\372\104\177\106\162\232"
	"\113\262\213\006\106\025\126\344\017\266\376\034\203\142\324\233"
	"\141\252\155\227\007\230\136\067\051\175\010\015\257\266\177\126"
	"\146\333\212\310\321\215\377\062\273\117\241\213\141\234\047\070"
	"\176\126\365\256\117\211\344\124\167\071\213\355\341\310\153\232"
	"\150\041\067\366\237\311\352\121\134\345\063\145\146\044\052\157"
	"\017\074\206\120\221\006\214\315\102\272\122\370\140\062\175\070"
	"\212\023\271\111\231\145\043\071\213\113\326\110\101\060\270\121"
	"\155\076\241\377\105\056\314\207\350\037\177\111\121\375\201\333"
	"\020\072\045\252\240\110\343\053\224\272\164\325\352\054\047\130"
	"\153\310\127\260\367\044\070\340\103\270\052\224\265\253\160\306"
	"\346\225\160\206\336\124\262\162\016\047\110\371\124\160\121\277"
	"\071\251\160\060\315\250\021\020\140\073\245\026\347\025\334\315"
	"\253\115\123\211\241\006\374\260\056\105\251\202\265\372\102\356"
	"\243\262\037\161\133\060\202\274\154\047\322\123\075\257\040\350"
	"\374\164\162\236\172\157\116\251\264\367\053\152\362\155\131\226"
	"\040\170\007\174\251\212\070\025\261\013\150\357\272\210\330\267"
	"\375\112\125\170\272\244\041\157\234\114\331\216\272\063\045\333"
	"\253\055\127\124\267\217\152\151\232\322\130\125\133\061\014\131"
	"\174\142\321\066\006\362\245\242\077\177\061\372\262\126\325\136"
	"\203\054\263\073\274\035\244\127\360\375\254\114\056\271\245\252"
	"\033\167\340\042\151\206\304\251\006\366\243\270\114\171\026\320"
	"\245\312\013\142\347\257\271\330\255\145\044\333\036\312\206\072"
	"\101\147\134\253\355\041\124\363\027\370\254\143\161\303\064\027"
	"\215\077\171\165\357\062\115\235\230\162\170\267\074\377\362\176"
	"\146\116\051\124\157\176\110\207\166\365\353\347\270\037\376\106"
	"\137\167\273\117\252\011\354\103\173\145\373\270\144\355\067\313"
	"\074\140\040\254\336\150\063\124\136\037\074\026\076\072\135\235"
	"\262\030\355\135\041\331\241\235\076\234\126\243\212\215\156\307"
	"\356\217\163\314\367\247\041\125\306\135\154\005\230\311\243\112"
	"\342\220\250\004\151\111\242\250\346\370\114\160\206\273\067\164"
	"\112\253\100\102\123\142\230\031\300\004\037\130\316\302\243\261"
	"\122\113\265\274\225\130\145\173\121\261\354\327\155\043\113\267"
	"\317\214\371\042\356\221\074\256\226\133\007\144\036\253\026\160"
	"\367\314\055\214\044\223\007\165\104\363\114\261\027\230\151\347"
	"\045\142\012\023\363\107\302\212\243\312\356\301\165\005\062\154"
	"\321\137\371\366\362\000\153\067\364\270\351\014\121\122\363\166"
	"\265\376\212\251\105\115\063\350\027\042\251\215\047\333\371\371"
	"\073\362\357\056\363\132\145\350\023\117\364\145\242\350\333\130"
	"\347\145\001\054\262\064\025\312\127\276\127\176\232\121\167\326"
	"\104\147\004\070\302\152\041\325\271\026\072\134\377\026\264\346"
	"\173\266\022\056\353\047\371\102\346\121\301\201\243\070\127\350"
	"\240\133\040\142\306\102\067\177\130\162\334\127\210\221\075\004"
	"\107\120\063\062\170\054\164\136\176\065\340\041\156\067\011\016"
	"\223\052\160\131\154\250\331\304\033\265\033\243\107\131\250\216"
	"\251\334\300\041\010\065\200\207\152\140\250\330\230\262\347\054"
	"\335\127\205\112\000\136\016\033\024\052\277\133\204\147\352\055"
	"\103\252\117\114\337\317\323\112\060\174\043\311\057\012\365\014"
	"\142\172\127\142\331\145\176\356\220\075\112\024\245\064\102\350"
#define      chk2_z	19
#define      chk2	((&data[5248]))
	"\277\141\120\017\071\233\373\304\154\127\276\135\171\065\012\000"
	"\152\330\355\134\053\011"
#define      msg1_z	65
#define      msg1	((&data[5277]))
	"\054\133\265\067\120\302\232\313\031\373\116\143\015\307\167\347"
	"\164\132\077\065\250\332\062\170\202\246\260\054\344\160\324\124"
	"\112\341\104\150\122\370\056\232\176\000\030\336\075\361\051\057"
	"\122\300\106\336\061\216\303\217\033\155\152\222\222\060\214\344"
	"\075\062\255\172\376\056\304\332\314\234\375\245\177\173\224\020"
	"\271\336"
#define      date_z	1
#define      date	((&data[5350]))
	"\267"
#define      msg2_z	19
#define      msg2	((&data[5352]))
	"\371\146\351\056\274\203\361\173\100\321\254\366\031\121\307\225"
	"\005\213\027\344\174\262\132\205"
#define      shll_z	10
#define      shll	((&data[5377]))
	"\351\110\151\304\005\063\111\362\055\050\317\131"
#define      inlo_z	3
#define      inlo	((&data[5387]))
	"\325\121\173"
#define      xecc_z	15
#define      xecc	((&data[5392]))
	"\235\270\067\105\207\043\251\111\376\007\012\151\056\245\026\213"
	"\234\012"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
