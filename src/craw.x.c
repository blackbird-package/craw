#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/devel/project/blackbird/apps/craw/src/craw -o /home/devel/project/blackbird/apps/craw/pkg/craw 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\177"
#define      chk2_z	19
#define      chk2	((&data[2]))
	"\171\121\147\331\252\347\373\135\345\030\001\006\054\154\350\220"
	"\126\130\035\233\346\366"
#define      msg1_z	65
#define      msg1	((&data[26]))
	"\257\006\113\026\246\371\052\076\056\112\115\165\001\337\373\061"
	"\325\362\306\360\217\224\332\363\066\175\015\204\244\377\312\372"
	"\361\375\046\226\005\177\133\367\055\063\035\253\046\123\167\351"
	"\034\360\120\077\007\176\230\144\120\072\142\343\322\311\131\351"
	"\071\264\066\027\136\075\321\022\217"
#define      text_z	3789
#define      text	((&data[126]))
	"\216\317\023\206\243\344\223\022\125\236\342\106\372\162\300\340"
	"\151\332\026\302\212\034\016\350\132\337\373\352\265\003\011\221"
	"\352\300\021\166\274\126\341\265\320\260\034\004\046\254\117\165"
	"\255\230\031\345\127\374\070\337\202\370\112\106\025\355\013\154"
	"\263\064\046\327\310\146\264\313\254\343\065\015\046\203\151\220"
	"\344\376\056\132\365\177\170\031\376\000\077\141\165\262\170\250"
	"\360\360\304\216\172\134\274\051\336\366\377\315\051\216\363\063"
	"\331\326\033\112\161\176\162\123\363\240\304\056\267\271\007\113"
	"\155\241\312\210\173\356\001\143\040\222\376\012\215\365\217\224"
	"\240\203\374\042\376\203\133\320\125\246\302\006\351\255\072\171"
	"\312\350\177\162\343\262\050\111\354\060\125\214\215\071\352\246"
	"\237\052\107\264\113\302\242\124\231\040\333\111\313\153\155\133"
	"\135\360\213\053\330\372\375\031\106\114\013\004\025\343\376\062"
	"\051\325\345\074\025\332\026\303\320\007\050\043\333\023\316\207"
	"\155\211\370\026\153\302\207\347\014\207\314\377\150\250\161\127"
	"\142\070\176\137\356\011\317\116\325\027\173\357\075\106\016\243"
	"\367\122\020\232\233\122\374\211\015\366\257\066\145\001\052\027"
	"\366\164\016\104\335\371\272\331\041\255\272\341\220\316\210\000"
	"\111\317\365\223\253\117\163\035\335\152\233\240\033\073\040\106"
	"\132\160\223\336\252\244\221\063\122\327\370\214\375\321\165\057"
	"\304\143\367\012\216\245\302\304\213\047\014\102\340\260\323\042"
	"\037\241\140\336\067\311\034\371\136\310\131\242\266\227\342\340"
	"\106\060\031\261\226\126\260\256\170\120\111\016\021\013\066\354"
	"\307\315\344\360\024\273\213\031\202\104\147\032\302\207\163\024"
	"\203\356\243\322\353\256\220\207\041\231\255\152\114\333\227\261"
	"\214\165\245\052\210\034\002\162\026\010\110\101\037\161\136\264"
	"\041\024\341\054\125\107\167\216\272\066\042\217\075\301\157\366"
	"\206\333\101\102\075\043\044\370\333\371\221\136\254\077\036\254"
	"\253\234\235\235\141\073\052\272\366\363\270\343\071\142\075\066"
	"\370\163\364\314\277\335\110\277\317\154\053\313\160\120\006\214"
	"\045\077\225\123\374\042\012\212\367\235\223\160\175\266\005\265"
	"\027\234\245\257\154\275\013\132\354\201\152\271\151\144\323\131"
	"\044\250\265\045\265\321\034\325\000\234\223\115\000\147\347\061"
	"\311\302\044\244\201\125\132\234\367\134\135\035\364\032\257\340"
	"\257\170\321\057\066\265\077\221\301\145\201\347\117\274\145\121"
	"\345\031\114\372\363\146\220\153\000\325\312\200\345\343\073\125"
	"\357\251\007\316\147\064\115\173\301\310\265\255\045\074\307\301"
	"\263\025\173\120\241\136\025\045\362\072\047\363\121\271\076\263"
	"\151\140\337\254\074\206\006\065\026\211\205\220\115\204\060\212"
	"\253\226\071\151\172\220\027\347\062\371\167\156\314\027\214\044"
	"\124\127\142\165\170\376\334\354\361\200\011\012\230\313\316\117"
	"\244\152\217\204\211\364\324\221\051\111\213\050\200\114\321\144"
	"\265\212\210\341\015\147\164\204\100\307\370\343\021\223\143\007"
	"\272\034\013\130\146\346\061\240\153\203\165\176\357\303\125\140"
	"\365\056\326\115\164\222\062\011\263\134\171\262\141\205\271\110"
	"\311\305\013\046\222\055\335\242\126\362\362\143\046\160\363\303"
	"\210\202\313\073\300\347\311\204\064\317\330\007\373\324\352\271"
	"\201\164\026\041\270\053\043\065\072\300\021\324\346\155\225\075"
	"\106\332\342\265\360\050\102\373\012\012\127\272\124\373\360\137"
	"\157\072\017\156\201\012\031\211\233\324\267\077\074\143\050\337"
	"\357\013\347\361\307\200\376\044\202\112\054\054\204\240\163\210"
	"\136\357\076\330\132\306\146\255\004\347\224\037\205\177\267\147"
	"\177\364\277\331\055\260\112\132\144\343\214\004\310\305\272\040"
	"\217\273\030\065\217\033\216\107\304\134\273\325\353\052\044\117"
	"\062\241\277\050\111\126\026\106\254\352\072\114\153\035\010\341"
	"\135\226\254\327\153\206\302\204\326\125\162\052\332\311\032\140"
	"\114\202\157\234\327\065\203\263\033\355\050\030\146\366\200\073"
	"\110\077\313\014\016\276\366\024\243\330\167\151\360\337\336\135"
	"\126\352\267\226\102\003\006\056\347\162\203\162\060\246\345\015"
	"\156\237\074\354\004\062\354\157\317\151\345\072\106\342\073\070"
	"\256\224\020\023\124\022\017\271\157\327\221\332\205\200\242\065"
	"\260\206\251\164\212\173\062\362\025\362\367\006\125\350\230\056"
	"\201\265\361\145\133\156\211\351\306\007\212\351\274\276\375\307"
	"\260\053\024\151\256\073\025\376\265\005\226\304\331\063\325\331"
	"\137\153\321\362\076\052\131\322\054\131\151\124\253\201\063\000"
	"\172\240\366\070\225\142\010\215\156\376\053\120\155\226\333\303"
	"\153\316\107\131\274\162\262\123\276\370\376\073\067\000\370\124"
	"\323\216\024\140\262\217\061\061\374\312\045\141\150\110\217\230"
	"\000\030\303\114\240\243\210\170\000\134\204\171\253\161\162\352"
	"\166\052\175\175\252\047\210\351\161\354\255\246\112\127\003\153"
	"\114\014\010\101\046\247\373\207\252\367\163\325\142\173\067\177"
	"\344\304\024\103\371\342\070\167\355\064\031\130\154\051\063\054"
	"\015\100\100\255\233\151\323\232\234\035\314\311\115\345\271\314"
	"\013\155\016\373\172\023\025\315\005\104\227\103\317\332\312\004"
	"\223\373\034\222\236\342\322\127\326\074\252\103\316\350\012\313"
	"\236\324\232\314\276\323\371\340\272\334\204\152\006\135\125\221"
	"\217\337\106\234\107\044\257\167\253\114\202\202\233\104\342\314"
	"\264\117\130\171\046\015\252\257\104\227\233\234\312\255\101\011"
	"\032\256\037\346\071\100\133\175\317\113\177\000\043\050\227\206"
	"\165\344\304\050\157\120\104\012\337\207\161\001\347\070\262\370"
	"\163\016\210\241\213\264\026\125\003\227\377\163\264\365\202\324"
	"\377\136\252\115\135\164\222\005\073\042\036\273\046\367\334\362"
	"\115\335\143\364\252\156\330\355\362\270\130\241\102\357\310\121"
	"\041\051\012\162\022\132\246\346\177\121\120\222\036\111\177\304"
	"\125\363\342\345\331\154\065\217\276\007\174\376\116\245\003\063"
	"\152\236\113\236\073\244\126\002\353\307\370\217\000\351\013\240"
	"\305\175\057\264\377\207\354\374\146\027\354\201\021\223\205\353"
	"\204\114\260\323\243\216\323\162\032\201\163\055\242\031\344\333"
	"\035\164\212\061\043\243\305\110\042\104\214\305\360\000\133\135"
	"\262\270\015\212\120\124\227\304\120\132\050\214\352\164\324\051"
	"\227\371\137\346\200\013\327\225\367\003\052\372\020\147\274\315"
	"\076\072\356\232\227\370\167\106\037\124\105\254\232\376\270\312"
	"\026\253\217\361\061\161\133\253\024\247\173\256\031\117\304\036"
	"\175\043\325\136\173\260\052\033\046\224\347\224\117\067\214\251"
	"\374\050\122\307\327\151\231\275\156\242\166\074\143\307\254\126"
	"\351\211\012\202\047\201\204\151\042\307\203\116\277\147\350\203"
	"\101\200\353\120\044\277\240\122\335\275\336\176\135\003\362\233"
	"\052\027\057\003\041\017\321\247\276\001\067\021\201\163\072\306"
	"\237\203\077\110\360\034\033\362\157\350\054\130\167\031\063\256"
	"\140\346\101\235\313\160\014\142\276\224\333\331\264\174\060\160"
	"\045\262\117\204\160\100\200\176\073\046\030\201\230\325\277\254"
	"\346\052\321\167\155\016\010\341\316\314\104\256\023\220\241\325"
	"\040\077\251\136\042\027\331\023\117\361\020\130\077\060\055\273"
	"\012\357\172\106\360\030\362\270\111\200\142\231\020\156\227\001"
	"\177\042\323\005\276\260\236\122\304\111\357\106\314\156\113\153"
	"\165\227\255\263\026\120\161\143\314\144\125\001\052\244\046\217"
	"\356\141\237\216\325\365\330\154\324\167\043\230\357\156\217\325"
	"\020\263\011\024\132\046\200\360\110\327\363\046\033\363\065\076"
	"\120\056\046\101\122\356\334\254\051\143\072\234\300\146\255\253"
	"\335\036\306\276\036\053\320\313\250\252\163\252\041\344\024\237"
	"\103\315\201\003\005\004\176\143\367\216\137\221\365\041\050\254"
	"\372\066\070\057\011\324\116\223\300\005\314\321\346\205\171\366"
	"\335\324\371\261\127\045\317\022\304\056\376\210\141\037\363\161"
	"\023\013\325\056\262\241\342\235\116\134\365\375\313\372\275\121"
	"\150\155\042\216\376\376\247\372\335\376\265\030\237\314\201\116"
	"\365\115\374\145\132\363\261\325\031\304\232\310\013\042\373\307"
	"\207\243\337\124\264\145\266\175\034\122\343\175\212\005\237\103"
	"\224\204\253\177\003\230\312\031\325\334\225\255\271\102\376\260"
	"\011\215\162\070\244\357\212\325\157\301\301\066\174\046\377\266"
	"\324\045\354\122\174\032\132\161\213\142\230\103\155\024\127\201"
	"\163\025\050\360\273\224\063\232\075\001\104\366\061\226\134\065"
	"\232\124\211\056\217\344\336\101\026\011\021\107\352\132\365\020"
	"\124\175\005\267\122\350\315\107\030\364\210\062\175\260\241\076"
	"\001\037\201\332\126\310\045\337\265\211\207\042\357\271\333\107"
	"\374\113\373\310\324\240\275\141\104\150\317\374\165\371\224\156"
	"\052\104\345\174\004\023\230\314\324\123\007\234\067\113\313\052"
	"\173\316\352\242\235\073\327\300\175\274\342\020\375\237\243\312"
	"\327\034\360\274\140\253\015\312\101\245\011\274\007\156\371\217"
	"\225\216\072\322\110\076\265\172\363\015\333\223\112\163\373\222"
	"\247\154\354\265\347\172\265\021\217\343\072\117\007\261\152\200"
	"\207\222\024\241\145\316\043\326\265\115\126\147\037\357\303\164"
	"\102\034\177\150\023\016\342\025\024\065\135\363\314\306\023\322"
	"\031\006\126\151\121\002\240\026\136\374\370\033\371\266\363\024"
	"\317\251\071\163\103\227\200\361\137\370\354\325\010\337\223\363"
	"\115\112\273\115\300\063\234\262\275\263\023\106\357\111\116\007"
	"\301\006\362\237\107\026\323\266\324\133\217\253\064\376\073\042"
	"\263\350\335\116\167\175\141\343\124\230\066\130\271\320\114\060"
	"\157\005\163\077\272\253\043\350\335\124\036\203\334\171\022\204"
	"\145\236\120\223\013\372\257\326\250\274\247\222\303\174\203\021"
	"\323\075\013\054\166\261\147\332\142\064\304\352\330\147\274\045"
	"\175\260\221\265\255\050\200\275\330\160\172\062\154\047\125\134"
	"\374\121\202\176\266\331\252\152\250\141\271\045\177\342\375\203"
	"\076\222\361\266\330\312\330\044\234\311\154\375\022\216\357\174"
	"\357\164\065\340\321\101\167\047\057\253\320\376\353\072\330\377"
	"\201\047\276\234\355\130\032\364\101\216\353\220\107\067\305\122"
	"\071\266\050\323\351\030\335\245\310\303\244\267\237\252\321\021"
	"\162\124\236\156\065\317\152\066\024\205\342\163\135\030\151\336"
	"\014\051\203\245\303\121\170\205\062\277\244\104\133\002\057\223"
	"\263\253\275\034\216\002\350\217\364\360\345\150\016\035\230\204"
	"\320\071\173\067\370\371\352\113\020\361\226\314\211\005\152\315"
	"\173\253\017\252\325\203\104\240\021\363\173\072\246\165\347\326"
	"\324\320\304\302\324\227\156\161\145\131\125\144\030\146\330\345"
	"\330\312\326\071\352\354\105\223\033\055\302\312\237\342\305\055"
	"\310\277\026\053\342\136\121\367\045\303\011\027\212\116\176\001"
	"\110\217\143\024\327\137\377\022\103\026\307\054\044\050\131\122"
	"\146\067\365\341\174\255\313\015\031\162\127\251\114\067\064\140"
	"\365\361\036\362\203\220\302\103\021\177\070\011\250\260\277\151"
	"\220\133\372\260\276\017\337\142\356\373\344\376\211\172\174\263"
	"\273\372\347\322\247\002\256\141\254\004\047\360\113\013\355\360"
	"\132\051\322\063\204\142\251\040\365\031\264\011\144\275\113\013"
	"\220\105\363\065\045\333\163\165\034\167\234\072\033\357\110\141"
	"\256\003\120\343\307\065\061\132\307\302\240\230\265\232\300\006"
	"\255\131\063\326\371\075\265\075\170\222\111\202\227\056\004\052"
	"\254\134\121\034\336\145\014\153\116\060\260\351\106\343\162\050"
	"\307\243\350\265\362\016\322\141\024\277\011\220\111\250\043\220"
	"\343\324\360\167\260\137\123\041\140\305\243\260\254\340\241\170"
	"\257\364\116\122\072\215\252\177\170\255\140\123\076\053\223\202"
	"\341\275\235\075\014\271\350\040\310\207\172\321\003\204\055\373"
	"\017\246\000\336\375\270\110\120\307\110\367\161\005\104\360\101"
	"\310\332\372\142\306\007\217\222\113\135\043\040\147\007\012\223"
	"\312\116\121\210\314\003\202\043\141\061\006\265\201\275\121\375"
	"\251\320\163\042\306\077\060\067\065\315\273\006\173\045\245\263"
	"\134\326\343\242\217\132\213\052\237\376\312\261\202\252\151\057"
	"\174\107\153\220\376\227\011\130\072\302\110\036\217\102\272\173"
	"\001\330\326\335\302\316\015\141\126\073\251\347\360\322\337\251"
	"\045\363\211\350\246\105\145\124\367\040\270\371\045\244\363\353"
	"\114\053\224\357\156\253\136\045\012\132\065\005\257\330\050\225"
	"\070\341\043\254\335\224\152\210\073\131\373\111\201\246\270\006"
	"\254\173\376\164\270\164\125\336\117\101\222\061\324\366\162\014"
	"\161\244\234\017\213\346\305\344\011\103\011\031\036\040\062\360"
	"\214\234\331\273\235\145\371\267\024\173\320\242\015\062\331\046"
	"\155\023\003\057\241\275\145\210\274\123\055\065\322\157\016\153"
	"\216\223\015\120\237\357\143\135\377\157\335\264\120\101\144\030"
	"\151\346\314\201\117\335\075\221\355\217\205\155\060\254\117\171"
	"\227\022\001\127\343\055\377\225\172\130\337\147\036\341\132\270"
	"\040\120\211\231\026\273\372\127\224\324\336\140\012\142\260\047"
	"\024\172\263\362\244\170\330\240\176\115\116\172\007\335\327\331"
	"\370\077\115\124\051\361\132\150\121\252\356\054\300\046\300\255"
	"\341\152\002\055\137\077\172\143\017\206\250\046\141\125\347\176"
	"\147\224\264\314\172\016\023\144\030\144\322\072\314\131\020\223"
	"\133\203\112\217\234\071\241\264\105\223\214\026\274\274\152\021"
	"\303\201\264\376\012\315\214\210\036\131\070\371\164\341\070\145"
	"\163\021\311\322\365\150\136\350\156\230\320\303\330\241\045\255"
	"\042\025\351\356\306\323\235\201\073\123\206\200\353\170\205\151"
	"\064\013\245\166\347\071\014\233\055\037\233\063\305\054\373\315"
	"\002\113\244\000\223\024\032\230\037\141\174\071\044\042\063\072"
	"\014\363\237\156\060\062\073\355\227\123\222\320\255\204\357\067"
	"\174\100\343\144\245\333\252\377\117\216\160\337\176\007\361\247"
	"\027\111\012\226\177\066\142\215\232\060\051\110\177\323\014\150"
	"\303\315\153\203\330\107\153\265\222\276\117\377\367\177\017\355"
	"\327\001\250\370\011\300\335\374\114\121\175\166\126\302\361\013"
	"\261\125\171\164\326\354\152\317\174\053\102\060\170\077\364\172"
	"\064\355\137\346\170\103\037\270\220\147\137\325\301\174\045\000"
	"\025\212\323\151\031\152\342\114\346\074\230\376\247\162\152\062"
	"\016\322\004\350\352\056\250\304\371\107\373\244\256\033\054\225"
	"\114\152\051\270\026\231\312\277\250\131\014\114\113\057\305\340"
	"\107\107\005\207\062\152\171\303\005\337\150\170\155\221\103\154"
	"\333\360\132\143\143\167\272\362\163\235\205\220\244\077\141\126"
	"\006\221\320\356\270\074\326\055\131\005\144\227\133\067\031\124"
	"\065\363\102\234\204\346\214\271\364\141\330\036\230\074\152\172"
	"\206\147\301\140\213\053\341\055\232\242\251\346\335\141\252\276"
	"\057\057\110\023\101\106\266\120\053\126\063\304\156\372\061\136"
	"\367\115\122\062\314\343\250\325\342\213\132\311\072\110\013\210"
	"\006\125\073\041\333\005\120\244\262\375\357\014\265\245\331\144"
	"\004\237\252\031\237\132\267\244\176\130\130\027\366\360\133\374"
	"\305\126\146\104\110\217\232\214\014\052\314\031\320\331\207\073"
	"\370\316\274\145\015\333\210\236\105\136\336\005\204\167\143\072"
	"\201\342\015\236\255\116\245\024\334\324\164\236\343\047\102\262"
	"\117\130\254\064\236\076\055\350\372\206\043\312\251\224\257\301"
	"\173\374\170\244\213\207\207\156\215\305\320\011\213\353\371\354"
	"\105\302\004\253\372\373\273\303\201\355\337\170\372\010\364\023"
	"\277\277\137\126\030\233\330\147\057\354\154\356\364\167\256\261"
	"\103\340\270\230\237\370\151\221\047\104\023\107\122\006\250\071"
	"\344\104\053\377\246\230\052\123\120\362\122\201\274\170\332\235"
	"\276\071\165\342\016\112\156\233\274\305\362\032\236\143\156\161"
	"\156\063\016\112\031\172\264\367\362\012\376\332\100\373\351\231"
	"\336\146\323\313\013\333\155\027\347\213\242\324\033\103\335\110"
	"\010\277\103\131\252\066\171\342\235\064\030\363\104\137\272\150"
	"\362\363\220\344\017\116\366\334\252\252\070\160\326\107\157\076"
	"\177\316\155\357\242\337\004\341\120\204\221\366\033\006\152\363"
	"\232\300\216\141\037\273\176\351\340\117\013\326\072\062\362\011"
	"\170\003\374\275\200\340\062\164\064\225\036\234\010\033\030\156"
	"\372\102\303\306\115\274\132\061\013\254\352\312\224\053\107\255"
	"\237\222\217\332\120\344\022\204\205\172\235\024\231\266\347\067"
	"\326\016\136\213\366\124\151\046\121\327\311\077\305\263\127\025"
	"\266\064\135\260\353\261\370\345\321\351\273\061\315\206\126\353"
	"\067\373\057\311\122\217\357\243\136\343\345\213\305\064\301\122"
	"\126\163\177\113\241\123\204\325\055\220\254\270\001\333\301\062"
	"\271\210\135\342\001\177\374\200\350\101\246\300\103\322\324\312"
	"\165\270\135\207\016\373\152\124\365\334\024\326\105\357\355\010"
	"\172\012\026\142\144\366\136\116\253\141\017\357\063\343\271\251"
	"\234\026\060\252\022\233\377\007\170\024\336\275\004\313\306\176"
	"\325\335\341\072\323\077\211\177\241\230\156\324\173\047\176\030"
	"\076\257\303\120\112\302\130\302\327\066\200\334\002\107\133\330"
	"\044\074\022\370\174\233\167\036\063\346\362\257\016\161\307\114"
	"\040\212\235\152\115\366\055\045\055\255\001\057\364\134\007\031"
	"\231\031\021\026\265\211\064\351\157\047\230\175\230\140\312\270"
	"\352\147\043\070\135\120\136\213\375\137\272\362\274\302\013\125"
	"\334\035\154\221\246\240\172\026\310\023\223\140\163\135\031\136"
	"\305\074\226\043\214\364\256\212\124\150\174\020\053\210\146\007"
	"\246\322\230\114\163\023\142\073\046\366\234\231\124\265\367\031"
	"\362\216\075\176\202\353\011\327\124\206\347\177\017\116\206\265"
	"\041\037\001\224\062\144\317\130\133\154\362\257\041\351\310\023"
	"\167\005\222\372\361\233\321\105\042\271\305\061\007\113\346\050"
	"\153\350\275\235\115\215\366\250\371\350\127\032\321\040\056\111"
	"\046\300\104\027\134\025\135\177\317\043\261\327\156\230\000\332"
	"\200\275\170\316\112\156\167\104\127\317\137\050\357\215\162\026"
	"\116\266\056\253\314\214\052\233\257\334\163\036\164\163\370\365"
	"\061\160\303\174\337\072\300\066\011\037\137\371\255\321\020\374"
	"\210\077\247\124\313\322\360\172\256\144\231\042\327\221\027\010"
	"\002\333\204\342\026\105\030\037\144\167\031\022\111\052\016\322"
	"\151\266\047\064\211\030\257\067\174\110\132\123\332\162\134\335"
	"\116\341\277\144\046\330\204\213\117\236\235\231\310\254\153\061"
	"\142\223\146\353\253\025\043\047\136\176\173\071\361\327\027\077"
	"\270\326\243\337\256\050\152\376\306\010\230\216\264\004\277\026"
	"\227\046\002\103\074\046\152\232\244\345\324\226\275\353\325\166"
	"\302\171\125\161\241\277\160\147\310\011\366\174\015\266\223\245"
	"\334\225\350\030\274\123\263\141\071\210\367\366\164\315\155\066"
	"\106\302\250\350\202\030\120\112\042\106\307\057\374\132\325\331"
	"\360\276\361\254\021\245\015\112\055\004\101\242\322\256\330\030"
	"\161\201\001\364\232\121\077\274\230\006\354\224\140\301\156\120"
	"\200\137\374\221\005\012\334\063\017\036\325\341\315\256\371\077"
	"\057\373\063\311\114\162\206\344\170\162\171\331\064\347\051\264"
	"\107\046\106\115\060\043\200\077\102\126\040\017\004\032\116\064"
	"\025\202\376\142\364\204\107\155\367\300\107\053\250\160\340\360"
	"\227\046\075\310\112\276\010\214\024\051\234\031\103\352\115\131"
	"\155\114\274\142\320\003\317\307\304\026\363\155\207\323\135\037"
	"\372\232\347\104\130\357\321\154\030\155\206\134\130\324\266\305"
	"\040\162\047\361\166\367\271\072\016\254\247\225\200\004\264\172"
	"\237\234\276\367\214\220\144\244\375\352\001\126\276\267\033\337"
	"\052\103\320\240\072\212\333\110\066\202\336\266\207\223\061\046"
	"\057\360\036\273\200\202\140\176\155\141\324\054\031\357\013\103"
	"\062\334\344\155\146\277\265\234\102\224\123\311\047\204\360\127"
	"\164\016\022\364\221\163\162\377\324\107\053\356\066\066\061\151"
	"\022\025\327\171\325\215\026\027\041\151\340\110\356\321\237\142"
	"\340\262\127\162\045\312\161\372\021\234\350\110\323\032\262\345"
	"\060\211\137\005\026\165\034\067\336\375\200\314\317\040\057\257"
	"\323\207\041\370\121\222\363\143\056\334\253\001\366\136\347\047"
	"\347\106\054"
#define      pswd_z	256
#define      pswd	((&data[4754]))
	"\065\232\106\266\147\026\327\227\305\252\036\347\243\160\171\226"
	"\324\250\162\200\252\151\336\221\220\305\330\275\303\225\006\371"
	"\057\115\257\227\143\206\057\051\060\116\020\323\276\211\152\236"
	"\302\051\156\002\303\162\273\232\163\323\272\257\130\113\156\101"
	"\320\141\264\221\370\167\206\262\177\047\056\361\242\313\217\144"
	"\365\375\147\270\157\042\123\342\365\016\222\116\131\001\217\052"
	"\143\104\273\133\273\101\015\073\150\074\055\013\010\274\160\375"
	"\272\327\265\052\372\010\014\360\027\237\077\160\241\316\232\004"
	"\022\125\140\316\227\156\012\000\252\067\013\262\364\173\257\256"
	"\123\145\330\116\156\345\076\205\204\175\365\046\114\220\052\137"
	"\345\212\056\175\371\070\175\243\160\210\126\144\004\006\022\130"
	"\154\352\246\332\317\344\140\124\142\126\173\256\346\245\015\314"
	"\060\073\111\051\164\306\315\344\117\044\110\123\053\132\254\227"
	"\105\122\162\025\067\322\152\231\050\345\107\017\213\125\333\274"
	"\221\045\346\006\354\264\352\073\330\063\217\003\216\073\233\323"
	"\216\015\351\305\337\123\136\010\071\246\030\304\374\364\200\216"
	"\031\147\224\005\033\177\101\363\262\321\367\100\015\222\024\233"
	"\240\375\140\200\121\277\210\212\146\240\117\143\224\320\361\256"
	"\067\205\264\122\005\365\106\267\306\075\370\323\320\014\157\223"
	"\062\335\023\334\106\361\156\327\266\107\224\172\334\233\163\014"
	"\350"
#define      date_z	1
#define      date	((&data[5028]))
	"\243"
#define      msg2_z	19
#define      msg2	((&data[5033]))
	"\332\041\205\256\367\105\171\320\347\353\312\270\245\143\250\122"
	"\037\057\257\202\254\223\265\340\017"
#define      shll_z	10
#define      shll	((&data[5055]))
	"\365\325\364\106\256\364\006\151\177\165\077"
#define      tst1_z	22
#define      tst1	((&data[5065]))
	"\231\072\041\001\055\031\302\163\237\135\235\235\352\300\225\162"
	"\126\160\010\204\215\361\167"
#define      chk1_z	22
#define      chk1	((&data[5088]))
	"\350\264\173\342\314\346\145\221\046\203\263\252\017\167\015\326"
	"\147\240\113\037\266\153\323"
#define      rlax_z	1
#define      rlax	((&data[5111]))
	"\022"
#define      inlo_z	3
#define      inlo	((&data[5112]))
	"\043\146\201"
#define      xecc_z	15
#define      xecc	((&data[5115]))
	"\322\214\032\144\342\341\352\235\206\105\153\364\302\161\370\170"
#define      tst2_z	19
#define      tst2	((&data[5131]))
	"\013\307\171\062\074\022\270\345\333\344\006\327\243\272\227\107"
	"\175\216\306\303\124\163\161"
#define      opts_z	1
#define      opts	((&data[5154]))
	"\315"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
